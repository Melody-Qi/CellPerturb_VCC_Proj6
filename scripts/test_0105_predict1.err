INFO:state._cli._tx._predict:Loaded config from checkpoints/third_run20251124/config.yaml
INFO:cell_load.data_modules.perturbation_dataloader:Loaded data module configuration from ./checkpoints/third_run20251124/data_module.torch
INFO:cell_load.config:Configuration validation passed
INFO:cell_load.data_modules.perturbation_dataloader:Initializing DataModule: batch_size=8, workers=12, random_seed=42
INFO:cell_load.data_modules.perturbation_dataloader:Set 2 missing perturbations to zero vectors.
INFO:cell_load.data_modules.perturbation_dataloader:Loaded custom perturbation featurizations for 19792 perturbations.
INFO:cell_load.data_modules.perturbation_dataloader:Processing dataset vcc:
INFO:cell_load.data_modules.perturbation_dataloader:  - Training dataset: True
INFO:cell_load.data_modules.perturbation_dataloader:  - Zeroshot cell types: []
INFO:cell_load.data_modules.perturbation_dataloader:  - Fewshot cell types: ['ARC_H1']
Processing vcc:   0%|          | 0/1 [00:00<?, ?it/s]                                                     Processing vcc:   0%|          | 0/1 [00:00<?, ?it/s]Processing vcc: 100%|██████████| 1/1 [00:00<00:00,  1.84it/s]Processing vcc: 100%|██████████| 1/1 [00:00<00:00,  1.84it/s]
INFO:cell_load.data_modules.perturbation_dataloader:

INFO:cell_load.data_modules.perturbation_dataloader:Done! Train / Val / Test splits: 1 / 1 / 1
INFO:state._cli._tx._predict:Loaded data module from ./checkpoints/third_run20251124/data_module.torch
[rank: 0] Seed set to 42
INFO:state._cli._tx._predict:Loading model from ./checkpoints/third_run20251124/checkpoints/step=step=18000-val_loss=val_loss=0.4595.ckpt
INFO:state.tx.models.base:Loaded decoder from checkpoint decoder_cfg: {'latent_dim': 1000, 'gene_dim': 18080, 'hidden_dims': [1024, 1024, 512], 'dropout': 0.1, 'residual_decoder': False}
INFO:state._cli._tx._predict:Model loaded successfully.
INFO:cell_load.data_modules.samplers:Creating perturbation batch sampler with metadata caching (using codes)...
INFO:cell_load.data_modules.samplers:Total # cells 78121. Cell set size mean / std before resampling: 63.10 / 6.18.
INFO:cell_load.data_modules.samplers:Creating meta-batches with cell_sentence_len=64...
INFO:cell_load.data_modules.samplers:Of all batches, 1238 were full and 0 were partial.
INFO:cell_load.data_modules.samplers:Sampler created with 1238 batches in 0.03 seconds.
INFO:state._cli._tx._predict:Generating predictions on test set using manual loop...
Predicting:   0%|          | 0/1238 [00:00<?, ?batch/s]INFO:cell_load.data_modules.samplers:Of all batches, 1238 were full and 0 were partial.
Predicting:   0%|          | 1/1238 [00:09<3:18:04,  9.61s/batch]Predicting:   0%|          | 3/1238 [00:09<52:06,  2.53s/batch]  Predicting:   0%|          | 5/1238 [00:09<25:55,  1.26s/batch]Predicting:   1%|          | 8/1238 [00:09<12:48,  1.60batch/s]Predicting:   1%|          | 11/1238 [00:10<07:42,  2.65batch/s]Predicting:   1%|          | 13/1238 [00:10<07:40,  2.66batch/s]Predicting:   1%|          | 15/1238 [00:11<06:46,  3.01batch/s]Predicting:   1%|▏         | 17/1238 [00:11<05:06,  3.98batch/s]Predicting:   2%|▏         | 19/1238 [00:11<03:56,  5.14batch/s]Predicting:   2%|▏         | 21/1238 [00:11<03:05,  6.55batch/s]Predicting:   2%|▏         | 23/1238 [00:11<02:34,  7.85batch/s]Predicting:   2%|▏         | 25/1238 [00:12<05:14,  3.85batch/s]Predicting:   2%|▏         | 27/1238 [00:13<05:53,  3.43batch/s]Predicting:   2%|▏         | 29/1238 [00:13<04:30,  4.46batch/s]Predicting:   3%|▎         | 31/1238 [00:14<04:20,  4.64batch/s]Predicting:   3%|▎         | 33/1238 [00:14<03:21,  5.98batch/s]Predicting:   3%|▎         | 35/1238 [00:14<02:41,  7.46batch/s]Predicting:   3%|▎         | 37/1238 [00:14<02:52,  6.96batch/s]Predicting:   3%|▎         | 39/1238 [00:15<04:24,  4.54batch/s]Predicting:   3%|▎         | 41/1238 [00:15<03:32,  5.64batch/s]Predicting:   3%|▎         | 42/1238 [00:16<04:48,  4.14batch/s]Predicting:   4%|▎         | 44/1238 [00:16<03:40,  5.40batch/s]Predicting:   4%|▎         | 46/1238 [00:16<02:59,  6.65batch/s]Predicting:   4%|▍         | 48/1238 [00:16<02:28,  8.01batch/s]Predicting:   4%|▍         | 50/1238 [00:17<03:14,  6.12batch/s]Predicting:   4%|▍         | 52/1238 [00:17<02:40,  7.38batch/s]Predicting:   4%|▍         | 54/1238 [00:17<03:53,  5.07batch/s]Predicting:   5%|▍         | 56/1238 [00:18<03:06,  6.32batch/s]Predicting:   5%|▍         | 58/1238 [00:18<02:43,  7.20batch/s]Predicting:   5%|▍         | 60/1238 [00:18<02:24,  8.15batch/s]Predicting:   5%|▌         | 62/1238 [00:18<02:04,  9.46batch/s]Predicting:   5%|▌         | 64/1238 [00:18<01:46, 11.00batch/s]Predicting:   5%|▌         | 66/1238 [00:19<02:55,  6.69batch/s]Predicting:   5%|▌         | 68/1238 [00:19<02:25,  8.05batch/s]Predicting:   6%|▌         | 70/1238 [00:19<02:19,  8.38batch/s]Predicting:   6%|▌         | 72/1238 [00:19<02:02,  9.53batch/s]Predicting:   6%|▌         | 74/1238 [00:20<02:09,  9.00batch/s]Predicting:   6%|▌         | 76/1238 [00:20<02:01,  9.56batch/s]Predicting:   6%|▋         | 78/1238 [00:20<03:17,  5.88batch/s]Predicting:   6%|▋         | 80/1238 [00:21<02:49,  6.82batch/s]Predicting:   7%|▋         | 81/1238 [00:21<02:48,  6.86batch/s]Predicting:   7%|▋         | 83/1238 [00:21<02:28,  7.76batch/s]Predicting:   7%|▋         | 85/1238 [00:21<02:12,  8.68batch/s]Predicting:   7%|▋         | 87/1238 [00:21<01:55,  9.96batch/s]Predicting:   7%|▋         | 89/1238 [00:21<02:02,  9.40batch/s]Predicting:   7%|▋         | 91/1238 [00:22<02:07,  8.97batch/s]Predicting:   7%|▋         | 92/1238 [00:22<02:07,  9.01batch/s]Predicting:   8%|▊         | 93/1238 [00:22<02:14,  8.52batch/s]Predicting:   8%|▊         | 95/1238 [00:22<02:20,  8.13batch/s]Predicting:   8%|▊         | 96/1238 [00:22<02:20,  8.14batch/s]Predicting:   8%|▊         | 98/1238 [00:22<01:55,  9.88batch/s]Predicting:   8%|▊         | 100/1238 [00:23<01:40, 11.36batch/s]Predicting:   8%|▊         | 102/1238 [00:23<01:38, 11.59batch/s]Predicting:   8%|▊         | 104/1238 [00:23<01:37, 11.68batch/s]Predicting:   9%|▊         | 106/1238 [00:23<01:33, 12.09batch/s]Predicting:   9%|▊         | 108/1238 [00:23<01:23, 13.56batch/s]Predicting:   9%|▉         | 110/1238 [00:23<01:49, 10.26batch/s]Predicting:   9%|▉         | 112/1238 [00:24<01:59,  9.40batch/s]Predicting:   9%|▉         | 114/1238 [00:24<01:56,  9.63batch/s]Predicting:   9%|▉         | 116/1238 [00:24<01:46, 10.57batch/s]Predicting:  10%|▉         | 118/1238 [00:24<01:49, 10.27batch/s]Predicting:  10%|▉         | 120/1238 [00:24<01:39, 11.29batch/s]Predicting:  10%|▉         | 122/1238 [00:25<01:29, 12.49batch/s]Predicting:  10%|█         | 124/1238 [00:25<01:24, 13.17batch/s]Predicting:  10%|█         | 126/1238 [00:25<01:47, 10.34batch/s]Predicting:  10%|█         | 128/1238 [00:25<01:43, 10.71batch/s]Predicting:  11%|█         | 130/1238 [00:25<01:39, 11.13batch/s]Predicting:  11%|█         | 132/1238 [00:25<01:33, 11.77batch/s]Predicting:  11%|█         | 134/1238 [00:26<01:34, 11.74batch/s]Predicting:  11%|█         | 136/1238 [00:26<01:27, 12.61batch/s]Predicting:  11%|█         | 138/1238 [00:26<01:31, 12.04batch/s]Predicting:  11%|█▏        | 140/1238 [00:26<01:29, 12.32batch/s]Predicting:  11%|█▏        | 142/1238 [00:26<01:33, 11.78batch/s]Predicting:  12%|█▏        | 144/1238 [00:26<01:28, 12.39batch/s]Predicting:  12%|█▏        | 146/1238 [00:27<01:33, 11.67batch/s]Predicting:  12%|█▏        | 148/1238 [00:27<01:36, 11.26batch/s]Predicting:  12%|█▏        | 151/1238 [00:27<01:19, 13.67batch/s]Predicting:  12%|█▏        | 153/1238 [00:27<01:33, 11.58batch/s]Predicting:  13%|█▎        | 155/1238 [00:27<01:29, 12.10batch/s]Predicting:  13%|█▎        | 157/1238 [00:27<01:27, 12.33batch/s]Predicting:  13%|█▎        | 159/1238 [00:28<01:21, 13.16batch/s]Predicting:  13%|█▎        | 161/1238 [00:28<01:35, 11.28batch/s]Predicting:  13%|█▎        | 163/1238 [00:28<01:28, 12.20batch/s]Predicting:  13%|█▎        | 165/1238 [00:28<01:21, 13.20batch/s]Predicting:  13%|█▎        | 167/1238 [00:28<01:14, 14.30batch/s]Predicting:  14%|█▎        | 169/1238 [00:28<01:25, 12.48batch/s]Predicting:  14%|█▍        | 171/1238 [00:29<01:25, 12.45batch/s]Predicting:  14%|█▍        | 173/1238 [00:29<01:24, 12.60batch/s]Predicting:  14%|█▍        | 175/1238 [00:29<01:24, 12.58batch/s]Predicting:  14%|█▍        | 177/1238 [00:29<01:23, 12.72batch/s]Predicting:  14%|█▍        | 179/1238 [00:29<01:16, 13.86batch/s]Predicting:  15%|█▍        | 181/1238 [00:29<01:21, 12.99batch/s]Predicting:  15%|█▍        | 183/1238 [00:29<01:15, 13.99batch/s]Predicting:  15%|█▍        | 185/1238 [00:30<01:19, 13.23batch/s]Predicting:  15%|█▌        | 187/1238 [00:30<01:24, 12.44batch/s]Predicting:  15%|█▌        | 189/1238 [00:30<01:21, 12.93batch/s]Predicting:  15%|█▌        | 191/1238 [00:30<01:15, 13.86batch/s]Predicting:  16%|█▌        | 193/1238 [00:30<01:18, 13.30batch/s]Predicting:  16%|█▌        | 195/1238 [00:30<01:21, 12.80batch/s]Predicting:  16%|█▌        | 197/1238 [00:31<01:13, 14.14batch/s]Predicting:  16%|█▌        | 200/1238 [00:31<01:04, 16.06batch/s]Predicting:  16%|█▋        | 202/1238 [00:31<01:04, 16.04batch/s]Predicting:  16%|█▋        | 204/1238 [00:31<01:12, 14.19batch/s]Predicting:  17%|█▋        | 206/1238 [00:31<01:29, 11.58batch/s]Predicting:  17%|█▋        | 208/1238 [00:31<01:22, 12.47batch/s]Predicting:  17%|█▋        | 210/1238 [00:31<01:18, 13.13batch/s]Predicting:  17%|█▋        | 212/1238 [00:32<01:14, 13.78batch/s]Predicting:  17%|█▋        | 214/1238 [00:32<01:26, 11.83batch/s]Predicting:  18%|█▊        | 217/1238 [00:32<01:13, 13.85batch/s]Predicting:  18%|█▊        | 219/1238 [00:32<01:19, 12.76batch/s]Predicting:  18%|█▊        | 221/1238 [00:32<01:22, 12.39batch/s]Predicting:  18%|█▊        | 223/1238 [00:32<01:14, 13.60batch/s]Predicting:  18%|█▊        | 225/1238 [00:33<01:10, 14.30batch/s]Predicting:  18%|█▊        | 227/1238 [00:33<01:27, 11.54batch/s]Predicting:  18%|█▊        | 229/1238 [00:33<01:16, 13.13batch/s]Predicting:  19%|█▊        | 231/1238 [00:33<01:15, 13.32batch/s]Predicting:  19%|█▉        | 233/1238 [00:33<01:08, 14.69batch/s]Predicting:  19%|█▉        | 236/1238 [00:33<01:02, 16.09batch/s]Predicting:  19%|█▉        | 238/1238 [00:34<01:20, 12.41batch/s]Predicting:  19%|█▉        | 240/1238 [00:34<01:20, 12.33batch/s]Predicting:  20%|█▉        | 242/1238 [00:34<01:16, 13.03batch/s]Predicting:  20%|█▉        | 244/1238 [00:34<01:11, 13.85batch/s]Predicting:  20%|█▉        | 246/1238 [00:34<01:18, 12.60batch/s]Predicting:  20%|██        | 248/1238 [00:34<01:10, 14.07batch/s]Predicting:  20%|██        | 250/1238 [00:34<01:10, 13.93batch/s]Predicting:  20%|██        | 252/1238 [00:35<01:13, 13.34batch/s]Predicting:  21%|██        | 254/1238 [00:35<01:18, 12.61batch/s]Predicting:  21%|██        | 256/1238 [00:35<01:09, 14.17batch/s]Predicting:  21%|██        | 258/1238 [00:35<01:16, 12.82batch/s]Predicting:  21%|██        | 260/1238 [00:35<01:12, 13.58batch/s]Predicting:  21%|██        | 262/1238 [00:35<01:18, 12.47batch/s]Predicting:  21%|██▏       | 264/1238 [00:36<01:14, 13.15batch/s]Predicting:  21%|██▏       | 266/1238 [00:36<01:20, 12.10batch/s]Predicting:  22%|██▏       | 269/1238 [00:36<01:07, 14.33batch/s]Predicting:  22%|██▏       | 271/1238 [00:36<01:20, 12.06batch/s]Predicting:  22%|██▏       | 273/1238 [00:36<01:13, 13.19batch/s]Predicting:  22%|██▏       | 275/1238 [00:36<01:07, 14.29batch/s]Predicting:  22%|██▏       | 277/1238 [00:37<01:09, 13.75batch/s]Predicting:  23%|██▎       | 279/1238 [00:37<01:04, 14.82batch/s]Predicting:  23%|██▎       | 281/1238 [00:37<01:03, 15.18batch/s]Predicting:  23%|██▎       | 283/1238 [00:37<01:03, 14.94batch/s]Predicting:  23%|██▎       | 285/1238 [00:37<01:15, 12.59batch/s]Predicting:  23%|██▎       | 287/1238 [00:37<01:11, 13.32batch/s]Predicting:  23%|██▎       | 289/1238 [00:37<01:13, 12.94batch/s]Predicting:  24%|██▎       | 291/1238 [00:38<01:13, 12.88batch/s]Predicting:  24%|██▎       | 293/1238 [00:38<01:11, 13.30batch/s]Predicting:  24%|██▍       | 295/1238 [00:38<01:07, 14.02batch/s]Predicting:  24%|██▍       | 297/1238 [00:38<01:20, 11.73batch/s]Predicting:  24%|██▍       | 299/1238 [00:38<01:23, 11.28batch/s]Predicting:  24%|██▍       | 301/1238 [00:38<01:14, 12.64batch/s]Predicting:  24%|██▍       | 303/1238 [00:39<01:15, 12.43batch/s]Predicting:  25%|██▍       | 305/1238 [00:39<01:08, 13.55batch/s]Predicting:  25%|██▍       | 307/1238 [00:39<01:06, 14.03batch/s]Predicting:  25%|██▍       | 309/1238 [00:39<01:12, 12.89batch/s]Predicting:  25%|██▌       | 311/1238 [00:39<01:08, 13.53batch/s]Predicting:  25%|██▌       | 313/1238 [00:39<01:06, 13.89batch/s]Predicting:  25%|██▌       | 315/1238 [00:39<01:11, 12.94batch/s]Predicting:  26%|██▌       | 317/1238 [00:40<01:07, 13.74batch/s]Predicting:  26%|██▌       | 319/1238 [00:40<01:06, 13.73batch/s]Predicting:  26%|██▌       | 321/1238 [00:40<01:09, 13.20batch/s]Predicting:  26%|██▌       | 323/1238 [00:40<01:03, 14.47batch/s]Predicting:  26%|██▋       | 325/1238 [00:40<01:02, 14.52batch/s]Predicting:  26%|██▋       | 327/1238 [00:40<01:07, 13.44batch/s]Predicting:  27%|██▋       | 329/1238 [00:40<01:06, 13.71batch/s]Predicting:  27%|██▋       | 331/1238 [00:41<01:09, 13.00batch/s]Predicting:  27%|██▋       | 333/1238 [00:41<01:05, 13.81batch/s]Predicting:  27%|██▋       | 335/1238 [00:41<01:05, 13.75batch/s]Predicting:  27%|██▋       | 337/1238 [00:41<01:07, 13.26batch/s]Predicting:  27%|██▋       | 339/1238 [00:41<01:04, 13.89batch/s]Predicting:  28%|██▊       | 341/1238 [00:41<01:10, 12.64batch/s]Predicting:  28%|██▊       | 343/1238 [00:42<01:10, 12.67batch/s]Predicting:  28%|██▊       | 346/1238 [00:42<00:59, 15.08batch/s]Predicting:  28%|██▊       | 348/1238 [00:42<01:07, 13.25batch/s]Predicting:  28%|██▊       | 350/1238 [00:42<01:03, 14.09batch/s]Predicting:  28%|██▊       | 352/1238 [00:42<00:57, 15.32batch/s]Predicting:  29%|██▊       | 354/1238 [00:42<01:04, 13.71batch/s]Predicting:  29%|██▉       | 356/1238 [00:42<01:04, 13.75batch/s]Predicting:  29%|██▉       | 358/1238 [00:43<01:02, 14.02batch/s]Predicting:  29%|██▉       | 360/1238 [00:43<01:09, 12.62batch/s]Predicting:  29%|██▉       | 362/1238 [00:43<01:08, 12.83batch/s]Predicting:  29%|██▉       | 364/1238 [00:43<01:05, 13.43batch/s]Predicting:  30%|██▉       | 366/1238 [00:43<01:03, 13.74batch/s]Predicting:  30%|██▉       | 369/1238 [00:43<00:59, 14.65batch/s]Predicting:  30%|██▉       | 371/1238 [00:44<01:08, 12.71batch/s]Predicting:  30%|███       | 373/1238 [00:44<01:05, 13.31batch/s]Predicting:  30%|███       | 375/1238 [00:44<01:02, 13.82batch/s]Predicting:  30%|███       | 377/1238 [00:44<01:00, 14.34batch/s]Predicting:  31%|███       | 379/1238 [00:44<01:05, 13.12batch/s]Predicting:  31%|███       | 381/1238 [00:44<01:12, 11.75batch/s]Predicting:  31%|███       | 383/1238 [00:44<01:10, 12.21batch/s]Predicting:  31%|███       | 385/1238 [00:45<01:09, 12.36batch/s]Predicting:  31%|███▏      | 387/1238 [00:45<01:04, 13.21batch/s]Predicting:  31%|███▏      | 389/1238 [00:45<01:08, 12.35batch/s]Predicting:  32%|███▏      | 391/1238 [00:45<01:05, 12.95batch/s]Predicting:  32%|███▏      | 393/1238 [00:45<00:59, 14.17batch/s]Predicting:  32%|███▏      | 395/1238 [00:45<00:58, 14.50batch/s]Predicting:  32%|███▏      | 397/1238 [00:46<01:05, 12.88batch/s]Predicting:  32%|███▏      | 399/1238 [00:46<01:00, 13.80batch/s]Predicting:  32%|███▏      | 401/1238 [00:46<00:57, 14.67batch/s]Predicting:  33%|███▎      | 403/1238 [00:46<00:57, 14.54batch/s]Predicting:  33%|███▎      | 405/1238 [00:46<01:03, 13.06batch/s]Predicting:  33%|███▎      | 407/1238 [00:46<01:07, 12.37batch/s]Predicting:  33%|███▎      | 409/1238 [00:46<01:03, 13.13batch/s]Predicting:  33%|███▎      | 411/1238 [00:47<01:05, 12.58batch/s]Predicting:  33%|███▎      | 413/1238 [00:47<01:01, 13.38batch/s]Predicting:  34%|███▎      | 415/1238 [00:47<00:57, 14.43batch/s]Predicting:  34%|███▎      | 417/1238 [00:47<01:03, 12.90batch/s]Predicting:  34%|███▍      | 419/1238 [00:47<01:00, 13.47batch/s]Predicting:  34%|███▍      | 421/1238 [00:47<00:55, 14.61batch/s]Predicting:  34%|███▍      | 423/1238 [00:47<01:05, 12.35batch/s]Predicting:  34%|███▍      | 425/1238 [00:48<01:03, 12.89batch/s]Predicting:  34%|███▍      | 427/1238 [00:48<01:00, 13.40batch/s]Predicting:  35%|███▍      | 429/1238 [00:48<01:01, 13.10batch/s]Predicting:  35%|███▍      | 431/1238 [00:48<01:04, 12.51batch/s]Predicting:  35%|███▍      | 433/1238 [00:48<00:59, 13.45batch/s]Predicting:  35%|███▌      | 435/1238 [00:48<01:00, 13.33batch/s]Predicting:  35%|███▌      | 437/1238 [00:49<01:00, 13.26batch/s]Predicting:  35%|███▌      | 439/1238 [00:49<01:03, 12.58batch/s]Predicting:  36%|███▌      | 441/1238 [00:49<01:04, 12.34batch/s]Predicting:  36%|███▌      | 443/1238 [00:49<01:06, 11.90batch/s]Predicting:  36%|███▌      | 445/1238 [00:49<01:02, 12.75batch/s]Predicting:  36%|███▌      | 447/1238 [00:49<00:59, 13.28batch/s]Predicting:  36%|███▋      | 449/1238 [00:49<00:56, 14.05batch/s]Predicting:  36%|███▋      | 451/1238 [00:50<00:58, 13.55batch/s]Predicting:  37%|███▋      | 453/1238 [00:50<01:00, 12.97batch/s]Predicting:  37%|███▋      | 455/1238 [00:50<00:55, 14.15batch/s]Predicting:  37%|███▋      | 457/1238 [00:50<01:01, 12.66batch/s]Predicting:  37%|███▋      | 459/1238 [00:50<00:59, 13.18batch/s]Predicting:  37%|███▋      | 461/1238 [00:50<00:58, 13.38batch/s]Predicting:  37%|███▋      | 463/1238 [00:51<01:00, 12.81batch/s]Predicting:  38%|███▊      | 465/1238 [00:51<00:55, 14.05batch/s]Predicting:  38%|███▊      | 467/1238 [00:51<00:53, 14.48batch/s]Predicting:  38%|███▊      | 469/1238 [00:51<00:55, 13.81batch/s]Predicting:  38%|███▊      | 471/1238 [00:51<01:00, 12.72batch/s]Predicting:  38%|███▊      | 473/1238 [00:51<00:56, 13.43batch/s]Predicting:  38%|███▊      | 475/1238 [00:51<00:58, 13.02batch/s]Predicting:  39%|███▊      | 478/1238 [00:52<00:48, 15.72batch/s]Predicting:  39%|███▉      | 480/1238 [00:52<00:56, 13.49batch/s]Predicting:  39%|███▉      | 482/1238 [00:52<01:03, 11.97batch/s]Predicting:  39%|███▉      | 484/1238 [00:52<00:58, 12.81batch/s]Predicting:  39%|███▉      | 486/1238 [00:52<00:57, 13.05batch/s]Predicting:  39%|███▉      | 488/1238 [00:52<00:58, 12.88batch/s]Predicting:  40%|███▉      | 491/1238 [00:53<00:50, 14.86batch/s]Predicting:  40%|███▉      | 493/1238 [00:53<00:55, 13.44batch/s]Predicting:  40%|███▉      | 495/1238 [00:53<00:58, 12.73batch/s]Predicting:  40%|████      | 497/1238 [00:53<00:57, 12.98batch/s]Predicting:  40%|████      | 499/1238 [00:53<00:56, 13.06batch/s]Predicting:  40%|████      | 501/1238 [00:53<00:54, 13.50batch/s]Predicting:  41%|████      | 503/1238 [00:53<00:51, 14.37batch/s]Predicting:  41%|████      | 505/1238 [00:54<00:57, 12.64batch/s]Predicting:  41%|████      | 507/1238 [00:54<01:01, 11.92batch/s]Predicting:  41%|████      | 509/1238 [00:54<01:01, 11.82batch/s]Predicting:  41%|████▏     | 511/1238 [00:54<00:57, 12.73batch/s]Predicting:  41%|████▏     | 513/1238 [00:54<00:52, 13.89batch/s]Predicting:  42%|████▏     | 515/1238 [00:54<00:59, 12.11batch/s]Predicting:  42%|████▏     | 517/1238 [00:55<00:55, 12.93batch/s]Predicting:  42%|████▏     | 519/1238 [00:55<00:53, 13.40batch/s]Predicting:  42%|████▏     | 521/1238 [00:55<00:57, 12.48batch/s]Predicting:  42%|████▏     | 523/1238 [00:55<00:57, 12.54batch/s]Predicting:  42%|████▏     | 525/1238 [00:55<00:52, 13.50batch/s]Predicting:  43%|████▎     | 527/1238 [00:55<00:57, 12.45batch/s]Predicting:  43%|████▎     | 529/1238 [00:56<00:53, 13.26batch/s]Predicting:  43%|████▎     | 531/1238 [00:56<00:51, 13.71batch/s]Predicting:  43%|████▎     | 533/1238 [00:56<00:53, 13.29batch/s]Predicting:  43%|████▎     | 535/1238 [00:56<00:56, 12.45batch/s]Predicting:  43%|████▎     | 537/1238 [00:56<00:53, 13.18batch/s]Predicting:  44%|████▎     | 539/1238 [00:56<00:52, 13.26batch/s]Predicting:  44%|████▎     | 541/1238 [00:56<00:51, 13.66batch/s]Predicting:  44%|████▍     | 543/1238 [00:57<00:49, 13.93batch/s]Predicting:  44%|████▍     | 545/1238 [00:57<00:47, 14.48batch/s]Predicting:  44%|████▍     | 547/1238 [00:57<00:46, 14.82batch/s]Predicting:  44%|████▍     | 549/1238 [00:57<00:47, 14.53batch/s]Predicting:  45%|████▍     | 551/1238 [00:57<00:54, 12.62batch/s]Predicting:  45%|████▍     | 553/1238 [00:57<00:50, 13.44batch/s]Predicting:  45%|████▍     | 555/1238 [00:57<00:49, 13.88batch/s]Predicting:  45%|████▍     | 557/1238 [00:58<00:52, 12.99batch/s]Predicting:  45%|████▌     | 559/1238 [00:58<00:53, 12.70batch/s]Predicting:  45%|████▌     | 561/1238 [00:58<00:49, 13.78batch/s]Predicting:  45%|████▌     | 563/1238 [00:58<00:52, 12.79batch/s]Predicting:  46%|████▌     | 565/1238 [00:58<00:47, 14.04batch/s]Predicting:  46%|████▌     | 567/1238 [00:58<00:54, 12.29batch/s]Predicting:  46%|████▌     | 569/1238 [00:59<00:51, 12.92batch/s]Predicting:  46%|████▌     | 571/1238 [00:59<00:49, 13.57batch/s]Predicting:  46%|████▋     | 573/1238 [00:59<00:47, 13.89batch/s]Predicting:  46%|████▋     | 575/1238 [00:59<00:51, 12.94batch/s]Predicting:  47%|████▋     | 577/1238 [00:59<00:48, 13.50batch/s]Predicting:  47%|████▋     | 579/1238 [00:59<00:53, 12.24batch/s]Predicting:  47%|████▋     | 581/1238 [00:59<00:50, 13.03batch/s]Predicting:  47%|████▋     | 583/1238 [01:00<00:53, 12.35batch/s]Predicting:  47%|████▋     | 585/1238 [01:00<00:52, 12.44batch/s]Predicting:  47%|████▋     | 587/1238 [01:00<00:48, 13.39batch/s]Predicting:  48%|████▊     | 589/1238 [01:00<00:51, 12.65batch/s]Predicting:  48%|████▊     | 591/1238 [01:00<00:48, 13.30batch/s]Predicting:  48%|████▊     | 593/1238 [01:00<00:45, 14.05batch/s]Predicting:  48%|████▊     | 595/1238 [01:00<00:44, 14.49batch/s]Predicting:  48%|████▊     | 597/1238 [01:01<00:47, 13.61batch/s]Predicting:  48%|████▊     | 599/1238 [01:01<00:48, 13.27batch/s]Predicting:  49%|████▊     | 601/1238 [01:01<00:50, 12.67batch/s]Predicting:  49%|████▊     | 603/1238 [01:01<00:49, 12.73batch/s]Predicting:  49%|████▉     | 605/1238 [01:01<00:49, 12.70batch/s]Predicting:  49%|████▉     | 607/1238 [01:01<00:46, 13.62batch/s]Predicting:  49%|████▉     | 609/1238 [01:02<00:48, 12.93batch/s]Predicting:  49%|████▉     | 611/1238 [01:02<00:48, 13.02batch/s]Predicting:  50%|████▉     | 613/1238 [01:02<00:46, 13.36batch/s]Predicting:  50%|████▉     | 615/1238 [01:02<00:42, 14.64batch/s]Predicting:  50%|████▉     | 617/1238 [01:02<00:47, 12.98batch/s]Predicting:  50%|█████     | 619/1238 [01:02<00:49, 12.57batch/s]Predicting:  50%|█████     | 621/1238 [01:03<00:50, 12.32batch/s]Predicting:  50%|█████     | 623/1238 [01:03<00:46, 13.26batch/s]Predicting:  50%|█████     | 625/1238 [01:03<00:46, 13.31batch/s]Predicting:  51%|█████     | 627/1238 [01:03<00:45, 13.36batch/s]Predicting:  51%|█████     | 629/1238 [01:03<00:48, 12.55batch/s]Predicting:  51%|█████     | 631/1238 [01:03<00:45, 13.25batch/s]Predicting:  51%|█████     | 633/1238 [01:03<00:44, 13.62batch/s]Predicting:  51%|█████▏    | 635/1238 [01:04<00:42, 14.15batch/s]Predicting:  51%|█████▏    | 637/1238 [01:04<00:43, 13.94batch/s]Predicting:  52%|█████▏    | 639/1238 [01:04<00:42, 14.16batch/s]Predicting:  52%|█████▏    | 641/1238 [01:04<00:43, 13.64batch/s]Predicting:  52%|█████▏    | 643/1238 [01:04<00:40, 14.56batch/s]Predicting:  52%|█████▏    | 645/1238 [01:04<00:40, 14.62batch/s]Predicting:  52%|█████▏    | 647/1238 [01:04<00:40, 14.45batch/s]Predicting:  52%|█████▏    | 649/1238 [01:04<00:39, 15.02batch/s]Predicting:  53%|█████▎    | 651/1238 [01:05<00:40, 14.46batch/s]Predicting:  53%|█████▎    | 653/1238 [01:05<00:46, 12.57batch/s]Predicting:  53%|█████▎    | 655/1238 [01:05<00:46, 12.61batch/s]Predicting:  53%|█████▎    | 657/1238 [01:05<00:43, 13.24batch/s]Predicting:  53%|█████▎    | 659/1238 [01:05<00:42, 13.60batch/s]Predicting:  53%|█████▎    | 661/1238 [01:05<00:44, 13.05batch/s]Predicting:  54%|█████▎    | 663/1238 [01:06<00:46, 12.31batch/s]Predicting:  54%|█████▎    | 665/1238 [01:06<00:43, 13.14batch/s]Predicting:  54%|█████▍    | 667/1238 [01:06<00:44, 12.76batch/s]Predicting:  54%|█████▍    | 669/1238 [01:06<00:43, 13.23batch/s]Predicting:  54%|█████▍    | 671/1238 [01:06<00:41, 13.73batch/s]Predicting:  54%|█████▍    | 673/1238 [01:06<00:42, 13.25batch/s]Predicting:  55%|█████▍    | 675/1238 [01:06<00:42, 13.30batch/s]Predicting:  55%|█████▍    | 677/1238 [01:07<00:40, 13.76batch/s]Predicting:  55%|█████▍    | 679/1238 [01:07<00:38, 14.42batch/s]Predicting:  55%|█████▌    | 681/1238 [01:07<00:41, 13.46batch/s]Predicting:  55%|█████▌    | 683/1238 [01:07<00:42, 13.08batch/s]Predicting:  55%|█████▌    | 685/1238 [01:07<00:39, 13.86batch/s]Predicting:  56%|█████▌    | 688/1238 [01:07<00:34, 15.92batch/s]Predicting:  56%|█████▌    | 690/1238 [01:08<00:44, 12.41batch/s]Predicting:  56%|█████▌    | 692/1238 [01:08<00:41, 13.22batch/s]Predicting:  56%|█████▌    | 694/1238 [01:08<00:44, 12.27batch/s]Predicting:  56%|█████▌    | 696/1238 [01:08<00:41, 13.11batch/s]Predicting:  56%|█████▋    | 698/1238 [01:08<00:38, 14.09batch/s]Predicting:  57%|█████▋    | 701/1238 [01:08<00:38, 14.08batch/s]Predicting:  57%|█████▋    | 703/1238 [01:09<00:41, 12.78batch/s]Predicting:  57%|█████▋    | 705/1238 [01:09<00:42, 12.67batch/s]Predicting:  57%|█████▋    | 707/1238 [01:09<00:41, 12.73batch/s]Predicting:  57%|█████▋    | 709/1238 [01:09<00:39, 13.47batch/s]Predicting:  57%|█████▋    | 711/1238 [01:09<00:36, 14.45batch/s]Predicting:  58%|█████▊    | 713/1238 [01:09<00:37, 14.09batch/s]Predicting:  58%|█████▊    | 715/1238 [01:09<00:40, 12.85batch/s]Predicting:  58%|█████▊    | 717/1238 [01:10<00:40, 12.75batch/s]Predicting:  58%|█████▊    | 719/1238 [01:10<00:39, 13.11batch/s]Predicting:  58%|█████▊    | 721/1238 [01:10<00:37, 13.73batch/s]Predicting:  58%|█████▊    | 724/1238 [01:10<00:32, 15.60batch/s]Predicting:  59%|█████▊    | 726/1238 [01:10<00:40, 12.54batch/s]Predicting:  59%|█████▉    | 728/1238 [01:10<00:39, 13.05batch/s]Predicting:  59%|█████▉    | 730/1238 [01:11<00:37, 13.72batch/s]Predicting:  59%|█████▉    | 732/1238 [01:11<00:35, 14.06batch/s]Predicting:  59%|█████▉    | 734/1238 [01:11<00:34, 14.42batch/s]Predicting:  59%|█████▉    | 736/1238 [01:11<00:33, 14.78batch/s]Predicting:  60%|█████▉    | 738/1238 [01:11<00:36, 13.63batch/s]Predicting:  60%|█████▉    | 740/1238 [01:11<00:36, 13.47batch/s]Predicting:  60%|█████▉    | 742/1238 [01:11<00:35, 14.01batch/s]Predicting:  60%|██████    | 744/1238 [01:12<00:37, 13.18batch/s]Predicting:  60%|██████    | 746/1238 [01:12<00:33, 14.48batch/s]Predicting:  61%|██████    | 749/1238 [01:12<00:36, 13.54batch/s]Predicting:  61%|██████    | 751/1238 [01:12<00:36, 13.51batch/s]Predicting:  61%|██████    | 753/1238 [01:12<00:34, 13.99batch/s]Predicting:  61%|██████    | 755/1238 [01:12<00:34, 13.82batch/s]Predicting:  61%|██████    | 757/1238 [01:13<00:37, 12.96batch/s]Predicting:  61%|██████▏   | 759/1238 [01:13<00:35, 13.53batch/s]Predicting:  61%|██████▏   | 761/1238 [01:13<00:36, 13.14batch/s]Predicting:  62%|██████▏   | 763/1238 [01:13<00:33, 14.28batch/s]Predicting:  62%|██████▏   | 765/1238 [01:13<00:35, 13.39batch/s]Predicting:  62%|██████▏   | 767/1238 [01:13<00:33, 13.88batch/s]Predicting:  62%|██████▏   | 769/1238 [01:13<00:36, 12.77batch/s]Predicting:  62%|██████▏   | 771/1238 [01:14<00:35, 13.08batch/s]Predicting:  62%|██████▏   | 773/1238 [01:14<00:33, 14.07batch/s]Predicting:  63%|██████▎   | 775/1238 [01:14<00:35, 13.09batch/s]Predicting:  63%|██████▎   | 777/1238 [01:14<00:34, 13.22batch/s]Predicting:  63%|██████▎   | 779/1238 [01:14<00:35, 12.96batch/s]Predicting:  63%|██████▎   | 781/1238 [01:14<00:34, 13.43batch/s]Predicting:  63%|██████▎   | 783/1238 [01:14<00:33, 13.60batch/s]Predicting:  63%|██████▎   | 785/1238 [01:15<00:33, 13.73batch/s]Predicting:  64%|██████▎   | 787/1238 [01:15<00:34, 12.92batch/s]Predicting:  64%|██████▎   | 789/1238 [01:15<00:35, 12.80batch/s]Predicting:  64%|██████▍   | 791/1238 [01:15<00:35, 12.55batch/s]Predicting:  64%|██████▍   | 793/1238 [01:15<00:34, 13.01batch/s]Predicting:  64%|██████▍   | 795/1238 [01:15<00:32, 13.59batch/s]Predicting:  64%|██████▍   | 797/1238 [01:16<00:34, 12.85batch/s]Predicting:  65%|██████▍   | 799/1238 [01:16<00:32, 13.31batch/s]Predicting:  65%|██████▍   | 801/1238 [01:16<00:32, 13.53batch/s]Predicting:  65%|██████▍   | 803/1238 [01:16<00:36, 12.02batch/s]Predicting:  65%|██████▌   | 805/1238 [01:16<00:33, 13.05batch/s]Predicting:  65%|██████▌   | 807/1238 [01:16<00:33, 12.97batch/s]Predicting:  65%|██████▌   | 809/1238 [01:16<00:31, 13.50batch/s]Predicting:  66%|██████▌   | 811/1238 [01:17<00:36, 11.63batch/s]Predicting:  66%|██████▌   | 813/1238 [01:17<00:33, 12.75batch/s]Predicting:  66%|██████▌   | 815/1238 [01:17<00:32, 12.99batch/s]Predicting:  66%|██████▌   | 817/1238 [01:17<00:33, 12.73batch/s]Predicting:  66%|██████▌   | 819/1238 [01:17<00:31, 13.49batch/s]Predicting:  66%|██████▋   | 821/1238 [01:17<00:31, 13.09batch/s]Predicting:  66%|██████▋   | 823/1238 [01:18<00:28, 14.53batch/s]Predicting:  67%|██████▋   | 825/1238 [01:18<00:31, 13.04batch/s]Predicting:  67%|██████▋   | 827/1238 [01:18<00:29, 13.72batch/s]Predicting:  67%|██████▋   | 829/1238 [01:18<00:31, 12.97batch/s]Predicting:  67%|██████▋   | 831/1238 [01:18<00:29, 13.58batch/s]Predicting:  67%|██████▋   | 833/1238 [01:18<00:28, 14.22batch/s]Predicting:  67%|██████▋   | 835/1238 [01:18<00:33, 12.19batch/s]Predicting:  68%|██████▊   | 837/1238 [01:19<00:29, 13.48batch/s]Predicting:  68%|██████▊   | 840/1238 [01:19<00:23, 16.79batch/s]Predicting:  68%|██████▊   | 842/1238 [01:19<00:29, 13.44batch/s]Predicting:  68%|██████▊   | 844/1238 [01:19<00:32, 12.09batch/s]Predicting:  68%|██████▊   | 846/1238 [01:19<00:31, 12.27batch/s]Predicting:  68%|██████▊   | 848/1238 [01:19<00:30, 12.79batch/s]Predicting:  69%|██████▊   | 850/1238 [01:20<00:30, 12.54batch/s]Predicting:  69%|██████▉   | 852/1238 [01:20<00:30, 12.79batch/s]Predicting:  69%|██████▉   | 854/1238 [01:20<00:29, 12.96batch/s]Predicting:  69%|██████▉   | 856/1238 [01:20<00:28, 13.45batch/s]Predicting:  69%|██████▉   | 858/1238 [01:20<00:30, 12.36batch/s]Predicting:  69%|██████▉   | 860/1238 [01:20<00:28, 13.26batch/s]Predicting:  70%|██████▉   | 862/1238 [01:20<00:27, 13.58batch/s]Predicting:  70%|██████▉   | 864/1238 [01:21<00:28, 13.10batch/s]Predicting:  70%|██████▉   | 866/1238 [01:21<00:28, 12.95batch/s]Predicting:  70%|███████   | 868/1238 [01:21<00:27, 13.41batch/s]Predicting:  70%|███████   | 870/1238 [01:21<00:28, 13.00batch/s]Predicting:  70%|███████   | 872/1238 [01:21<00:26, 13.60batch/s]Predicting:  71%|███████   | 874/1238 [01:21<00:24, 14.82batch/s]Predicting:  71%|███████   | 876/1238 [01:22<00:26, 13.63batch/s]Predicting:  71%|███████   | 878/1238 [01:22<00:25, 14.15batch/s]Predicting:  71%|███████   | 880/1238 [01:22<00:26, 13.42batch/s]Predicting:  71%|███████   | 882/1238 [01:22<00:25, 14.22batch/s]Predicting:  71%|███████▏  | 884/1238 [01:22<00:23, 14.76batch/s]Predicting:  72%|███████▏  | 886/1238 [01:22<00:23, 15.06batch/s]Predicting:  72%|███████▏  | 888/1238 [01:22<00:23, 14.58batch/s]Predicting:  72%|███████▏  | 890/1238 [01:23<00:26, 12.98batch/s]Predicting:  72%|███████▏  | 892/1238 [01:23<00:23, 14.48batch/s]Predicting:  72%|███████▏  | 895/1238 [01:23<00:21, 16.17batch/s]Predicting:  72%|███████▏  | 897/1238 [01:23<00:25, 13.46batch/s]Predicting:  73%|███████▎  | 899/1238 [01:23<00:26, 12.58batch/s]Predicting:  73%|███████▎  | 901/1238 [01:23<00:26, 12.72batch/s]Predicting:  73%|███████▎  | 903/1238 [01:23<00:25, 13.25batch/s]Predicting:  73%|███████▎  | 906/1238 [01:24<00:20, 16.11batch/s]Predicting:  73%|███████▎  | 908/1238 [01:24<00:23, 13.83batch/s]Predicting:  74%|███████▎  | 910/1238 [01:24<00:26, 12.40batch/s]Predicting:  74%|███████▎  | 912/1238 [01:24<00:25, 13.03batch/s]Predicting:  74%|███████▍  | 914/1238 [01:24<00:24, 13.38batch/s]Predicting:  74%|███████▍  | 916/1238 [01:24<00:22, 14.38batch/s]Predicting:  74%|███████▍  | 919/1238 [01:25<00:19, 16.15batch/s]Predicting:  74%|███████▍  | 921/1238 [01:25<00:24, 12.94batch/s]Predicting:  75%|███████▍  | 923/1238 [01:25<00:22, 14.03batch/s]Predicting:  75%|███████▍  | 925/1238 [01:25<00:23, 13.18batch/s]Predicting:  75%|███████▍  | 927/1238 [01:25<00:22, 13.84batch/s]Predicting:  75%|███████▌  | 929/1238 [01:25<00:21, 14.27batch/s]Predicting:  75%|███████▌  | 931/1238 [01:25<00:23, 13.17batch/s]Predicting:  75%|███████▌  | 933/1238 [01:26<00:23, 12.91batch/s]Predicting:  76%|███████▌  | 935/1238 [01:26<00:21, 13.83batch/s]Predicting:  76%|███████▌  | 937/1238 [01:26<00:22, 13.36batch/s]Predicting:  76%|███████▌  | 939/1238 [01:26<00:22, 13.17batch/s]Predicting:  76%|███████▌  | 941/1238 [01:26<00:21, 13.61batch/s]Predicting:  76%|███████▌  | 943/1238 [01:26<00:20, 14.13batch/s]Predicting:  76%|███████▋  | 945/1238 [01:27<00:21, 13.57batch/s]Predicting:  76%|███████▋  | 947/1238 [01:27<00:19, 14.66batch/s]Predicting:  77%|███████▋  | 949/1238 [01:27<00:20, 14.41batch/s]Predicting:  77%|███████▋  | 951/1238 [01:27<00:20, 13.97batch/s]Predicting:  77%|███████▋  | 953/1238 [01:27<00:19, 14.69batch/s]Predicting:  77%|███████▋  | 955/1238 [01:27<00:18, 15.60batch/s]Predicting:  77%|███████▋  | 957/1238 [01:27<00:19, 14.05batch/s]Predicting:  77%|███████▋  | 959/1238 [01:28<00:21, 13.04batch/s]Predicting:  78%|███████▊  | 961/1238 [01:28<00:21, 12.81batch/s]Predicting:  78%|███████▊  | 963/1238 [01:28<00:21, 12.87batch/s]Predicting:  78%|███████▊  | 965/1238 [01:28<00:21, 12.93batch/s]Predicting:  78%|███████▊  | 967/1238 [01:28<00:20, 13.11batch/s]Predicting:  78%|███████▊  | 969/1238 [01:28<00:19, 13.69batch/s]Predicting:  78%|███████▊  | 971/1238 [01:28<00:20, 12.90batch/s]Predicting:  79%|███████▊  | 973/1238 [01:29<00:18, 14.17batch/s]Predicting:  79%|███████▉  | 975/1238 [01:29<00:18, 14.09batch/s]Predicting:  79%|███████▉  | 977/1238 [01:29<00:18, 13.90batch/s]Predicting:  79%|███████▉  | 979/1238 [01:29<00:19, 13.31batch/s]Predicting:  79%|███████▉  | 982/1238 [01:29<00:16, 15.70batch/s]Predicting:  79%|███████▉  | 984/1238 [01:29<00:20, 12.56batch/s]Predicting:  80%|███████▉  | 986/1238 [01:30<00:18, 13.59batch/s]Predicting:  80%|███████▉  | 988/1238 [01:30<00:17, 14.22batch/s]Predicting:  80%|███████▉  | 990/1238 [01:30<00:18, 13.14batch/s]Predicting:  80%|████████  | 992/1238 [01:30<00:17, 14.10batch/s]Predicting:  80%|████████  | 994/1238 [01:30<00:16, 15.00batch/s]Predicting:  80%|████████  | 996/1238 [01:30<00:18, 13.34batch/s]Predicting:  81%|████████  | 998/1238 [01:30<00:16, 14.13batch/s]Predicting:  81%|████████  | 1000/1238 [01:30<00:15, 15.47batch/s]Predicting:  81%|████████  | 1002/1238 [01:31<00:17, 13.36batch/s]Predicting:  81%|████████  | 1004/1238 [01:31<00:18, 12.99batch/s]Predicting:  81%|████████▏ | 1006/1238 [01:31<00:19, 11.96batch/s]Predicting:  81%|████████▏ | 1008/1238 [01:31<00:17, 12.88batch/s]Predicting:  82%|████████▏ | 1011/1238 [01:31<00:14, 15.93batch/s]Predicting:  82%|████████▏ | 1013/1238 [01:31<00:17, 13.18batch/s]Predicting:  82%|████████▏ | 1015/1238 [01:32<00:16, 13.33batch/s]Predicting:  82%|████████▏ | 1017/1238 [01:32<00:18, 12.11batch/s]Predicting:  82%|████████▏ | 1019/1238 [01:32<00:17, 12.87batch/s]Predicting:  82%|████████▏ | 1021/1238 [01:32<00:17, 12.12batch/s]Predicting:  83%|████████▎ | 1023/1238 [01:32<00:17, 12.42batch/s]Predicting:  83%|████████▎ | 1025/1238 [01:32<00:16, 12.61batch/s]Predicting:  83%|████████▎ | 1027/1238 [01:33<00:17, 12.13batch/s]Predicting:  83%|████████▎ | 1029/1238 [01:33<00:15, 13.44batch/s]Predicting:  83%|████████▎ | 1031/1238 [01:33<00:14, 13.95batch/s]Predicting:  83%|████████▎ | 1033/1238 [01:33<00:14, 14.33batch/s]Predicting:  84%|████████▎ | 1035/1238 [01:33<00:13, 15.29batch/s]Predicting:  84%|████████▍ | 1037/1238 [01:33<00:16, 12.20batch/s]Predicting:  84%|████████▍ | 1039/1238 [01:34<00:16, 12.36batch/s]Predicting:  84%|████████▍ | 1041/1238 [01:34<00:14, 13.39batch/s]Predicting:  84%|████████▍ | 1043/1238 [01:34<00:13, 14.64batch/s]Predicting:  84%|████████▍ | 1045/1238 [01:34<00:14, 13.38batch/s]Predicting:  85%|████████▍ | 1047/1238 [01:34<00:15, 11.98batch/s]Predicting:  85%|████████▍ | 1049/1238 [01:34<00:15, 12.22batch/s]Predicting:  85%|████████▍ | 1051/1238 [01:34<00:14, 13.09batch/s]Predicting:  85%|████████▌ | 1053/1238 [01:35<00:14, 12.76batch/s]Predicting:  85%|████████▌ | 1055/1238 [01:35<00:14, 13.02batch/s]Predicting:  85%|████████▌ | 1057/1238 [01:35<00:12, 14.04batch/s]Predicting:  86%|████████▌ | 1059/1238 [01:35<00:13, 13.52batch/s]Predicting:  86%|████████▌ | 1061/1238 [01:35<00:12, 14.09batch/s]Predicting:  86%|████████▌ | 1063/1238 [01:35<00:15, 11.63batch/s]Predicting:  86%|████████▌ | 1065/1238 [01:36<00:14, 12.34batch/s]Predicting:  86%|████████▌ | 1067/1238 [01:36<00:14, 11.48batch/s]Predicting:  86%|████████▋ | 1069/1238 [01:36<00:12, 13.11batch/s]Predicting:  87%|████████▋ | 1071/1238 [01:36<00:14, 11.92batch/s]Predicting:  87%|████████▋ | 1073/1238 [01:36<00:13, 12.66batch/s]Predicting:  87%|████████▋ | 1075/1238 [01:36<00:12, 12.89batch/s]Predicting:  87%|████████▋ | 1077/1238 [01:36<00:11, 13.96batch/s]Predicting:  87%|████████▋ | 1079/1238 [01:37<00:11, 13.36batch/s]Predicting:  87%|████████▋ | 1081/1238 [01:37<00:11, 13.28batch/s]Predicting:  87%|████████▋ | 1083/1238 [01:37<00:12, 12.61batch/s]Predicting:  88%|████████▊ | 1085/1238 [01:37<00:12, 11.93batch/s]Predicting:  88%|████████▊ | 1088/1238 [01:37<00:10, 13.65batch/s]Predicting:  88%|████████▊ | 1090/1238 [01:37<00:11, 12.42batch/s]Predicting:  88%|████████▊ | 1092/1238 [01:38<00:11, 13.12batch/s]Predicting:  88%|████████▊ | 1094/1238 [01:38<00:11, 12.12batch/s]Predicting:  89%|████████▊ | 1096/1238 [01:38<00:11, 12.89batch/s]Predicting:  89%|████████▊ | 1098/1238 [01:38<00:10, 12.99batch/s]Predicting:  89%|████████▉ | 1100/1238 [01:38<00:10, 12.81batch/s]Predicting:  89%|████████▉ | 1102/1238 [01:38<00:11, 12.16batch/s]Predicting:  89%|████████▉ | 1104/1238 [01:39<00:10, 12.89batch/s]Predicting:  89%|████████▉ | 1106/1238 [01:39<00:10, 12.03batch/s]Predicting:  89%|████████▉ | 1108/1238 [01:39<00:10, 12.97batch/s]Predicting:  90%|████████▉ | 1110/1238 [01:39<00:09, 13.08batch/s]Predicting:  90%|████████▉ | 1112/1238 [01:39<00:09, 13.44batch/s]Predicting:  90%|████████▉ | 1114/1238 [01:39<00:10, 11.87batch/s]Predicting:  90%|█████████ | 1116/1238 [01:40<00:09, 12.61batch/s]Predicting:  90%|█████████ | 1118/1238 [01:40<00:08, 13.39batch/s]Predicting:  90%|█████████ | 1120/1238 [01:40<00:09, 11.94batch/s]Predicting:  91%|█████████ | 1122/1238 [01:40<00:09, 12.59batch/s]Predicting:  91%|█████████ | 1124/1238 [01:40<00:08, 13.15batch/s]Predicting:  91%|█████████ | 1126/1238 [01:40<00:08, 12.45batch/s]Predicting:  91%|█████████ | 1128/1238 [01:40<00:09, 11.90batch/s]Predicting:  91%|█████████▏| 1130/1238 [01:41<00:08, 12.85batch/s]Predicting:  91%|█████████▏| 1132/1238 [01:41<00:07, 13.53batch/s]Predicting:  92%|█████████▏| 1134/1238 [01:41<00:08, 12.87batch/s]Predicting:  92%|█████████▏| 1136/1238 [01:41<00:07, 13.05batch/s]Predicting:  92%|█████████▏| 1138/1238 [01:41<00:07, 12.83batch/s]Predicting:  92%|█████████▏| 1140/1238 [01:41<00:07, 12.51batch/s]Predicting:  92%|█████████▏| 1142/1238 [01:42<00:07, 12.65batch/s]Predicting:  92%|█████████▏| 1144/1238 [01:42<00:07, 12.37batch/s]Predicting:  93%|█████████▎| 1146/1238 [01:42<00:06, 13.29batch/s]Predicting:  93%|█████████▎| 1148/1238 [01:42<00:06, 13.10batch/s]Predicting:  93%|█████████▎| 1150/1238 [01:42<00:07, 12.49batch/s]Predicting:  93%|█████████▎| 1152/1238 [01:42<00:06, 13.18batch/s]Predicting:  93%|█████████▎| 1154/1238 [01:42<00:06, 12.56batch/s]Predicting:  93%|█████████▎| 1156/1238 [01:43<00:05, 14.03batch/s]Predicting:  94%|█████████▎| 1158/1238 [01:43<00:05, 13.55batch/s]Predicting:  94%|█████████▎| 1160/1238 [01:43<00:05, 14.37batch/s]Predicting:  94%|█████████▍| 1162/1238 [01:43<00:05, 13.11batch/s]Predicting:  94%|█████████▍| 1164/1238 [01:43<00:06, 12.25batch/s]Predicting:  94%|█████████▍| 1166/1238 [01:43<00:05, 12.71batch/s]Predicting:  94%|█████████▍| 1168/1238 [01:44<00:05, 12.26batch/s]Predicting:  95%|█████████▍| 1170/1238 [01:44<00:05, 12.59batch/s]Predicting:  95%|█████████▍| 1172/1238 [01:44<00:05, 12.59batch/s]Predicting:  95%|█████████▍| 1174/1238 [01:44<00:04, 12.80batch/s]Predicting:  95%|█████████▍| 1176/1238 [01:44<00:04, 12.80batch/s]Predicting:  95%|█████████▌| 1178/1238 [01:44<00:04, 12.82batch/s]Predicting:  95%|█████████▌| 1180/1238 [01:44<00:04, 13.79batch/s]Predicting:  95%|█████████▌| 1182/1238 [01:45<00:04, 12.39batch/s]Predicting:  96%|█████████▌| 1184/1238 [01:45<00:04, 13.05batch/s]Predicting:  96%|█████████▌| 1186/1238 [01:45<00:04, 12.75batch/s]Predicting:  96%|█████████▌| 1188/1238 [01:45<00:03, 13.12batch/s]Predicting:  96%|█████████▌| 1190/1238 [01:45<00:03, 13.05batch/s]Predicting:  96%|█████████▋| 1192/1238 [01:45<00:03, 13.96batch/s]Predicting:  96%|█████████▋| 1194/1238 [01:46<00:03, 13.49batch/s]Predicting:  97%|█████████▋| 1196/1238 [01:46<00:03, 13.96batch/s]Predicting:  97%|█████████▋| 1198/1238 [01:46<00:03, 12.98batch/s]Predicting:  97%|█████████▋| 1200/1238 [01:46<00:02, 13.62batch/s]Predicting:  97%|█████████▋| 1202/1238 [01:46<00:02, 14.17batch/s]Predicting:  97%|█████████▋| 1204/1238 [01:46<00:02, 14.44batch/s]Predicting:  97%|█████████▋| 1206/1238 [01:46<00:02, 14.59batch/s]Predicting:  98%|█████████▊| 1208/1238 [01:47<00:02, 12.90batch/s]Predicting:  98%|█████████▊| 1210/1238 [01:47<00:02, 13.52batch/s]Predicting:  98%|█████████▊| 1212/1238 [01:47<00:01, 14.22batch/s]Predicting:  98%|█████████▊| 1214/1238 [01:47<00:01, 14.15batch/s]Predicting:  98%|█████████▊| 1216/1238 [01:47<00:01, 14.99batch/s]Predicting:  98%|█████████▊| 1219/1238 [01:47<00:01, 18.14batch/s]Predicting:  99%|█████████▉| 1223/1238 [01:47<00:00, 22.00batch/s]Predicting:  99%|█████████▉| 1226/1238 [01:47<00:00, 23.62batch/s]Predicting:  99%|█████████▉| 1229/1238 [01:48<00:00, 24.81batch/s]Predicting: 100%|█████████▉| 1232/1238 [01:48<00:00, 25.77batch/s]Predicting: 100%|█████████▉| 1235/1238 [01:48<00:00, 26.40batch/s]Predicting: 100%|██████████| 1238/1238 [01:48<00:00, 26.87batch/s]Predicting: 100%|██████████| 1238/1238 [01:48<00:00, 11.38batch/s]
INFO:state._cli._tx._predict:Creating anndatas from predictions from manual loop...
INFO:state._cli._tx._predict:Added predicted embeddings to adata.obsm['X_hvg']
... storing 'target_gene' as categorical
... storing 'cell_type' as categorical
... storing 'batch_var' as categorical
... storing 'ctrl_cell_barcode' as categorical
... storing 'target_gene' as categorical
... storing 'cell_type' as categorical
... storing 'batch_var' as categorical
... storing 'ctrl_cell_barcode' as categorical
INFO:state._cli._tx._predict:Saved adata_pred to checkpoints/third_run20251124/eval_step=step=18000-val_loss=val_loss=0.4595.ckpt/adata_pred.h5ad
INFO:state._cli._tx._predict:Saved adata_real to checkpoints/third_run20251124/eval_step=step=18000-val_loss=val_loss=0.4595.ckpt/adata_real.h5ad
INFO:state._cli._tx._predict:Computing metrics using cell-eval...
WARNING:cell_eval._evaluator:Output directory checkpoints/third_run20251124/eval_step=step=18000-val_loss=val_loss=0.4595.ckpt already exists, potential overwrite occurring
INFO:cell_eval.utils:Data appears to be log1p normalized (decimals detected, range [0.00, 6.88])
INFO:cell_eval._evaluator:Input is found to be log-normalized already - skipping transformation.
INFO:cell_eval.utils:Data appears to be log1p normalized (decimals detected, range [0.00, 11.41])
INFO:cell_eval._evaluator:Input is found to be log-normalized already - skipping transformation.
INFO:cell_eval._evaluator:Computing DE for real data
INFO:cell_eval._evaluator:Using the following pdex kwargs: {'exp_post_agg': True, 'is_log1p': True, 'reference': 'non-targeting', 'groupby_key': 'target_gene', 'num_workers': 40, 'batch_size': 2048, 'metric': 'wilcoxon', 'as_polars': True}
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/31 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 31/31 [00:00<00:00, 4529.49it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 2579793.04it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=560480
INFO:pdex._single_cell:Creating generator of all batches: N=274
INFO:pdex._single_cell:Initializing parallel processing pool
Traceback (most recent call last):
  File "/public/home/CS286/qiyt2023-CS286/miniconda3/envs/CellPerturb_VCC_Proj6_STATE2/bin/state", line 7, in <module>
    sys.exit(main())
  File "/public/home/CS286/qiyt2023-CS286/CellPerturb_VCC_Proj6_new4/STATE/src/state/__main__.py", line 123, in main
    run_tx_predict(args)
  File "/public/home/CS286/qiyt2023-CS286/CellPerturb_VCC_Proj6_new4/STATE/src/state/_cli/_tx/_predict.py", line 416, in run_tx_predict
    evaluator = MetricsEvaluator(
  File "/public/home/CS286/qiyt2023-CS286/miniconda3/envs/CellPerturb_VCC_Proj6_STATE2/lib/python3.10/site-packages/cell_eval/_evaluator.py", line 95, in __init__
    self.de_comparison = _build_de_comparison(
  File "/public/home/CS286/qiyt2023-CS286/miniconda3/envs/CellPerturb_VCC_Proj6_STATE2/lib/python3.10/site-packages/cell_eval/_evaluator.py", line 232, in _build_de_comparison
    real=_load_or_build_de(
  File "/public/home/CS286/qiyt2023-CS286/miniconda3/envs/CellPerturb_VCC_Proj6_STATE2/lib/python3.10/site-packages/cell_eval/_evaluator.py", line 316, in _load_or_build_de
    frame = parallel_differential_expression(
  File "/public/home/CS286/qiyt2023-CS286/miniconda3/envs/CellPerturb_VCC_Proj6_STATE2/lib/python3.10/site-packages/pdex/_single_cell.py", line 415, in parallel_differential_expression
    with mp.Pool(num_workers) as pool:
  File "/public/home/CS286/qiyt2023-CS286/miniconda3/envs/CellPerturb_VCC_Proj6_STATE2/lib/python3.10/multiprocessing/context.py", line 119, in Pool
    return Pool(processes, initializer, initargs, maxtasksperchild,
  File "/public/home/CS286/qiyt2023-CS286/miniconda3/envs/CellPerturb_VCC_Proj6_STATE2/lib/python3.10/multiprocessing/pool.py", line 215, in __init__
    self._repopulate_pool()
  File "/public/home/CS286/qiyt2023-CS286/miniconda3/envs/CellPerturb_VCC_Proj6_STATE2/lib/python3.10/multiprocessing/pool.py", line 306, in _repopulate_pool
    return self._repopulate_pool_static(self._ctx, self.Process,
  File "/public/home/CS286/qiyt2023-CS286/miniconda3/envs/CellPerturb_VCC_Proj6_STATE2/lib/python3.10/multiprocessing/pool.py", line 329, in _repopulate_pool_static
    w.start()
  File "/public/home/CS286/qiyt2023-CS286/miniconda3/envs/CellPerturb_VCC_Proj6_STATE2/lib/python3.10/multiprocessing/process.py", line 121, in start
    self._popen = self._Popen(self)
  File "/public/home/CS286/qiyt2023-CS286/miniconda3/envs/CellPerturb_VCC_Proj6_STATE2/lib/python3.10/multiprocessing/context.py", line 281, in _Popen
    return Popen(process_obj)
  File "/public/home/CS286/qiyt2023-CS286/miniconda3/envs/CellPerturb_VCC_Proj6_STATE2/lib/python3.10/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
  File "/public/home/CS286/qiyt2023-CS286/miniconda3/envs/CellPerturb_VCC_Proj6_STATE2/lib/python3.10/multiprocessing/popen_fork.py", line 66, in _launch
    self.pid = os.fork()
OSError: [Errno 12] Cannot allocate memory
/public/home/CS286/qiyt2023-CS286/miniconda3/envs/CellPerturb_VCC_Proj6_STATE2/lib/python3.10/multiprocessing/resource_tracker.py:224: UserWarning: resource_tracker: There appear to be 1 leaked shared_memory objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
