Mon Jan  5 20:14:48 2026       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.54.15              Driver Version: 550.54.15      CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA TITAN V                 On  |   00000000:18:00.0 Off |                  N/A |
| 28%   30C    P8             25W /  250W |       0MiB /  12288MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
=== SLURM环境变量 ===
SLURM_GPUS_PER_NODE: 
CUDA_VISIBLE_DEVICES: 0
=== PyTorch检测 ===
PyTorch检测GPU数: 1
可用GPU: ['NVIDIA TITAN V']
preprocessed_data/preprocessed_training_data_1000_with_obs.h5ad
vcc ARC_H1 {'val': 45, 'test': 30}
Processed preprocessed_training_data_1000_with_obs: 121975 train, 97529 val, 78121 test
StateTransitionPerturbationModel(
  (loss_fn): SamplesLoss()
  (gene_decoder): LatentToGeneDecoder(
    (decoder): Sequential(
      (0): Linear(in_features=1000, out_features=1024, bias=True)
      (1): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (2): GELU(approximate='none')
      (3): Dropout(p=0.1, inplace=False)
      (4): Linear(in_features=1024, out_features=1024, bias=True)
      (5): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (6): GELU(approximate='none')
      (7): Dropout(p=0.1, inplace=False)
      (8): Linear(in_features=1024, out_features=512, bias=True)
      (9): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      (10): GELU(approximate='none')
      (11): Dropout(p=0.1, inplace=False)
      (12): Linear(in_features=512, out_features=18080, bias=True)
      (13): ReLU()
    )
  )
  (pert_encoder): Sequential(
    (0): Linear(in_features=5120, out_features=328, bias=True)
    (1): GELU(approximate='none')
    (2): Dropout(p=0.1, inplace=False)
    (3): Linear(in_features=328, out_features=328, bias=True)
    (4): GELU(approximate='none')
    (5): Dropout(p=0.1, inplace=False)
    (6): Linear(in_features=328, out_features=328, bias=True)
    (7): GELU(approximate='none')
    (8): Dropout(p=0.1, inplace=False)
    (9): Linear(in_features=328, out_features=328, bias=True)
  )
  (basal_encoder): Linear(in_features=1000, out_features=328, bias=True)
  (transformer_backbone): GPT2BidirectionalModel(
    (wte): Embedding(50257, 328)
    (wpe): Embedding(64, 328)
    (drop): Dropout(p=0.0, inplace=False)
    (h): ModuleList(
      (0-7): 8 x GPT2Block(
        (ln_1): LayerNorm((328,), eps=1e-05, elementwise_affine=True)
        (attn): GPT2Attention(
          (c_attn): Conv1D(nf=984, nx=328)
          (c_proj): Conv1D(nf=328, nx=328)
          (attn_dropout): Dropout(p=0.0, inplace=False)
          (resid_dropout): Dropout(p=0.0, inplace=False)
        )
        (ln_2): LayerNorm((328,), eps=1e-05, elementwise_affine=True)
        (mlp): GPT2MLP(
          (c_fc): Conv1D(nf=1312, nx=328)
          (c_proj): Conv1D(nf=328, nx=1312)
          (act): NewGELUActivation()
          (dropout): Dropout(p=0.0, inplace=False)
        )
      )
    )
    (ln_f): LayerNorm((328,), eps=1e-05, elementwise_affine=True)
  )
  (project_out): Sequential(
    (0): Linear(in_features=328, out_features=328, bias=True)
    (1): GELU(approximate='none')
    (2): Dropout(p=0.1, inplace=False)
    (3): Linear(in_features=328, out_features=328, bias=True)
    (4): GELU(approximate='none')
    (5): Dropout(p=0.1, inplace=False)
    (6): Linear(in_features=328, out_features=328, bias=True)
    (7): GELU(approximate='none')
    (8): Dropout(p=0.1, inplace=False)
    (9): Linear(in_features=328, out_features=1000, bias=True)
  )
  (final_down_then_up): Sequential(
    (0): Linear(in_features=1000, out_features=125, bias=True)
    (1): GELU(approximate='none')
    (2): Linear(in_features=125, out_features=1000, bias=True)
  )
  (relu): ReLU()
)
