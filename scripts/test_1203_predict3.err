INFO:state._cli._tx._predict:Loaded config from checkpoints/forth_run20251202/config.yaml
INFO:cell_load.data_modules.perturbation_dataloader:Loaded data module configuration from ./checkpoints/forth_run20251202/data_module.torch
INFO:cell_load.config:Configuration validation passed
INFO:cell_load.data_modules.perturbation_dataloader:Initializing DataModule: batch_size=16, workers=12, random_seed=42
INFO:cell_load.data_modules.perturbation_dataloader:Set 2 missing perturbations to zero vectors.
INFO:cell_load.data_modules.perturbation_dataloader:Loaded custom perturbation featurizations for 19792 perturbations.
INFO:cell_load.data_modules.perturbation_dataloader:Processing dataset vcc:
INFO:cell_load.data_modules.perturbation_dataloader:  - Training dataset: True
INFO:cell_load.data_modules.perturbation_dataloader:  - Zeroshot cell types: []
INFO:cell_load.data_modules.perturbation_dataloader:  - Fewshot cell types: ['ARC_H1']
Processing vcc:   0%|          | 0/1 [00:00<?, ?it/s]                                                     Processing vcc:   0%|          | 0/1 [00:00<?, ?it/s]Processing vcc: 100%|██████████| 1/1 [00:00<00:00,  3.12it/s]Processing vcc: 100%|██████████| 1/1 [00:00<00:00,  3.12it/s]
INFO:cell_load.data_modules.perturbation_dataloader:

INFO:cell_load.data_modules.perturbation_dataloader:Done! Train / Val / Test splits: 1 / 1 / 1
INFO:state._cli._tx._predict:Loaded data module from ./checkpoints/forth_run20251202/data_module.torch
[rank: 0] Seed set to 42
INFO:state._cli._tx._predict:Loading model from ./checkpoints/forth_run20251202/checkpoints/step=10700.ckpt
INFO:state._cli._tx._predict:Model loaded successfully.
INFO:cell_load.data_modules.samplers:Creating perturbation batch sampler with metadata caching (using codes)...
INFO:cell_load.data_modules.samplers:Total # cells 68271. Cell set size mean / std before resampling: 124.36 / 17.58.
INFO:cell_load.data_modules.samplers:Creating meta-batches with cell_sentence_len=128...
INFO:cell_load.data_modules.samplers:Of all batches, 549 were full and 0 were partial.
INFO:cell_load.data_modules.samplers:Sampler created with 549 batches in 0.03 seconds.
INFO:state._cli._tx._predict:Generating predictions on test set using manual loop...
Predicting:   0%|          | 0/549 [00:00<?, ?batch/s]INFO:cell_load.data_modules.samplers:Of all batches, 549 were full and 0 were partial.
Predicting:   0%|          | 1/549 [00:12<1:51:40, 12.23s/batch]Predicting:   0%|          | 2/549 [00:12<46:42,  5.12s/batch]  Predicting:   1%|          | 4/549 [00:12<17:54,  1.97s/batch]Predicting:   1%|          | 6/549 [00:12<09:43,  1.07s/batch]Predicting:   1%|▏         | 8/549 [00:12<06:03,  1.49batch/s]Predicting:   2%|▏         | 10/549 [00:13<04:03,  2.21batch/s]Predicting:   2%|▏         | 12/549 [00:13<02:52,  3.11batch/s]Predicting:   3%|▎         | 14/549 [00:14<04:09,  2.15batch/s]Predicting:   3%|▎         | 16/549 [00:14<03:04,  2.88batch/s]Predicting:   3%|▎         | 18/549 [00:15<02:18,  3.83batch/s]Predicting:   4%|▎         | 20/549 [00:15<01:47,  4.91batch/s]Predicting:   4%|▍         | 22/549 [00:15<01:26,  6.10batch/s]Predicting:   4%|▍         | 24/549 [00:15<01:12,  7.23batch/s]Predicting:   5%|▍         | 26/549 [00:17<03:31,  2.47batch/s]Predicting:   5%|▍         | 27/549 [00:17<03:04,  2.83batch/s]Predicting:   5%|▌         | 29/549 [00:17<02:17,  3.79batch/s]Predicting:   6%|▌         | 31/549 [00:17<01:44,  4.97batch/s]Predicting:   6%|▌         | 33/549 [00:18<01:25,  6.06batch/s]Predicting:   6%|▋         | 35/549 [00:18<01:15,  6.85batch/s]Predicting:   7%|▋         | 37/549 [00:19<03:00,  2.84batch/s]Predicting:   7%|▋         | 38/549 [00:20<02:53,  2.94batch/s]Predicting:   7%|▋         | 39/549 [00:20<02:30,  3.40batch/s]Predicting:   7%|▋         | 40/549 [00:20<02:09,  3.95batch/s]Predicting:   7%|▋         | 41/549 [00:20<01:59,  4.26batch/s]Predicting:   8%|▊         | 43/549 [00:20<01:30,  5.61batch/s]Predicting:   8%|▊         | 45/549 [00:21<01:13,  6.82batch/s]Predicting:   9%|▊         | 47/549 [00:21<01:04,  7.73batch/s]Predicting:   9%|▉         | 49/549 [00:22<02:18,  3.61batch/s]Predicting:   9%|▉         | 50/549 [00:22<02:15,  3.69batch/s]Predicting:   9%|▉         | 51/549 [00:22<02:07,  3.92batch/s]Predicting:   9%|▉         | 52/549 [00:22<01:51,  4.44batch/s]Predicting:  10%|▉         | 53/549 [00:23<01:40,  4.92batch/s]Predicting:  10%|▉         | 54/549 [00:23<01:52,  4.40batch/s]Predicting:  10%|█         | 55/549 [00:23<01:37,  5.04batch/s]Predicting:  10%|█         | 56/549 [00:23<01:28,  5.56batch/s]Predicting:  10%|█         | 57/549 [00:23<01:20,  6.11batch/s]Predicting:  11%|█         | 58/549 [00:23<01:12,  6.74batch/s]Predicting:  11%|█         | 59/549 [00:24<01:51,  4.38batch/s]Predicting:  11%|█         | 60/549 [00:24<01:49,  4.45batch/s]Predicting:  11%|█         | 61/549 [00:24<01:54,  4.27batch/s]Predicting:  11%|█▏        | 62/549 [00:24<01:39,  4.89batch/s]Predicting:  11%|█▏        | 63/549 [00:25<01:31,  5.32batch/s]Predicting:  12%|█▏        | 64/549 [00:25<01:56,  4.18batch/s]Predicting:  12%|█▏        | 65/549 [00:25<02:09,  3.73batch/s]Predicting:  12%|█▏        | 66/549 [00:25<01:58,  4.07batch/s]Predicting:  12%|█▏        | 67/549 [00:26<01:53,  4.24batch/s]Predicting:  12%|█▏        | 68/549 [00:26<01:41,  4.75batch/s]Predicting:  13%|█▎        | 69/549 [00:26<01:34,  5.08batch/s]Predicting:  13%|█▎        | 70/549 [00:26<01:23,  5.75batch/s]Predicting:  13%|█▎        | 71/549 [00:26<01:27,  5.48batch/s]Predicting:  13%|█▎        | 72/549 [00:27<01:33,  5.09batch/s]Predicting:  13%|█▎        | 73/549 [00:27<01:49,  4.36batch/s]Predicting:  13%|█▎        | 74/549 [00:27<01:45,  4.52batch/s]Predicting:  14%|█▎        | 75/549 [00:27<01:47,  4.39batch/s]Predicting:  14%|█▍        | 76/549 [00:28<01:50,  4.28batch/s]Predicting:  14%|█▍        | 77/549 [00:28<01:46,  4.44batch/s]Predicting:  14%|█▍        | 78/549 [00:28<01:32,  5.08batch/s]Predicting:  14%|█▍        | 79/549 [00:28<01:22,  5.70batch/s]Predicting:  15%|█▍        | 80/549 [00:28<01:25,  5.49batch/s]Predicting:  15%|█▍        | 81/549 [00:28<01:31,  5.13batch/s]Predicting:  15%|█▍        | 82/549 [00:29<01:44,  4.46batch/s]Predicting:  15%|█▌        | 83/549 [00:29<01:49,  4.26batch/s]Predicting:  15%|█▌        | 84/549 [00:29<01:39,  4.68batch/s]Predicting:  15%|█▌        | 85/549 [00:29<01:34,  4.90batch/s]Predicting:  16%|█▌        | 86/549 [00:29<01:30,  5.14batch/s]Predicting:  16%|█▌        | 87/549 [00:30<01:27,  5.28batch/s]Predicting:  16%|█▌        | 88/549 [00:30<01:21,  5.69batch/s]Predicting:  16%|█▋        | 90/549 [00:30<01:00,  7.62batch/s]Predicting:  17%|█▋        | 91/549 [00:30<01:09,  6.63batch/s]Predicting:  17%|█▋        | 92/549 [00:30<01:11,  6.42batch/s]Predicting:  17%|█▋        | 93/549 [00:31<01:14,  6.10batch/s]Predicting:  17%|█▋        | 95/549 [00:31<01:11,  6.37batch/s]Predicting:  17%|█▋        | 96/549 [00:31<01:20,  5.64batch/s]Predicting:  18%|█▊        | 97/549 [00:31<01:22,  5.48batch/s]Predicting:  18%|█▊        | 98/549 [00:31<01:18,  5.73batch/s]Predicting:  18%|█▊        | 99/549 [00:32<01:23,  5.36batch/s]Predicting:  18%|█▊        | 100/549 [00:32<01:22,  5.44batch/s]Predicting:  18%|█▊        | 101/549 [00:32<01:24,  5.30batch/s]Predicting:  19%|█▊        | 102/549 [00:32<01:14,  6.01batch/s]Predicting:  19%|█▉        | 104/549 [00:32<00:58,  7.61batch/s]Predicting:  19%|█▉        | 106/549 [00:33<01:01,  7.22batch/s]Predicting:  19%|█▉        | 107/549 [00:33<01:12,  6.11batch/s]Predicting:  20%|█▉        | 108/549 [00:33<01:16,  5.76batch/s]Predicting:  20%|█▉        | 109/549 [00:33<01:24,  5.21batch/s]Predicting:  20%|██        | 110/549 [00:34<01:27,  4.99batch/s]Predicting:  20%|██        | 111/549 [00:34<01:24,  5.18batch/s]Predicting:  20%|██        | 112/549 [00:34<01:19,  5.48batch/s]Predicting:  21%|██        | 113/549 [00:34<01:15,  5.80batch/s]Predicting:  21%|██        | 115/549 [00:34<00:58,  7.43batch/s]Predicting:  21%|██▏       | 117/549 [00:34<00:57,  7.58batch/s]Predicting:  21%|██▏       | 118/549 [00:35<01:05,  6.55batch/s]Predicting:  22%|██▏       | 119/549 [00:35<01:08,  6.24batch/s]Predicting:  22%|██▏       | 120/549 [00:35<01:13,  5.86batch/s]Predicting:  22%|██▏       | 121/549 [00:35<01:19,  5.37batch/s]Predicting:  22%|██▏       | 122/549 [00:35<01:17,  5.53batch/s]Predicting:  22%|██▏       | 123/549 [00:36<01:13,  5.77batch/s]Predicting:  23%|██▎       | 124/549 [00:36<01:10,  6.04batch/s]Predicting:  23%|██▎       | 125/549 [00:36<01:10,  6.03batch/s]Predicting:  23%|██▎       | 126/549 [00:36<01:09,  6.13batch/s]Predicting:  23%|██▎       | 127/549 [00:36<01:03,  6.60batch/s]Predicting:  23%|██▎       | 128/549 [00:36<01:02,  6.75batch/s]Predicting:  23%|██▎       | 129/549 [00:36<01:01,  6.85batch/s]Predicting:  24%|██▍       | 131/549 [00:37<00:59,  6.98batch/s]Predicting:  24%|██▍       | 132/549 [00:37<00:59,  7.01batch/s]Predicting:  24%|██▍       | 133/549 [00:37<00:56,  7.40batch/s]Predicting:  25%|██▍       | 135/549 [00:37<00:56,  7.35batch/s]Predicting:  25%|██▍       | 136/549 [00:37<01:03,  6.45batch/s]Predicting:  25%|██▍       | 137/549 [00:38<01:07,  6.08batch/s]Predicting:  25%|██▌       | 138/549 [00:38<01:11,  5.74batch/s]Predicting:  25%|██▌       | 139/549 [00:38<01:19,  5.18batch/s]Predicting:  26%|██▌       | 140/549 [00:38<01:17,  5.30batch/s]Predicting:  26%|██▌       | 142/549 [00:38<00:59,  6.82batch/s]Predicting:  26%|██▌       | 143/549 [00:39<01:05,  6.22batch/s]Predicting:  26%|██▌       | 144/549 [00:39<01:09,  5.81batch/s]Predicting:  26%|██▋       | 145/549 [00:39<01:13,  5.51batch/s]Predicting:  27%|██▋       | 146/549 [00:39<01:09,  5.84batch/s]Predicting:  27%|██▋       | 147/549 [00:39<01:15,  5.32batch/s]Predicting:  27%|██▋       | 148/549 [00:40<01:11,  5.60batch/s]Predicting:  27%|██▋       | 149/549 [00:40<01:09,  5.78batch/s]Predicting:  28%|██▊       | 151/549 [00:40<01:03,  6.30batch/s]Predicting:  28%|██▊       | 152/549 [00:40<01:02,  6.38batch/s]Predicting:  28%|██▊       | 153/549 [00:40<00:56,  7.00batch/s]Predicting:  28%|██▊       | 154/549 [00:40<00:58,  6.80batch/s]Predicting:  28%|██▊       | 155/549 [00:41<01:00,  6.51batch/s]Predicting:  28%|██▊       | 156/549 [00:41<01:07,  5.81batch/s]Predicting:  29%|██▊       | 157/549 [00:41<01:11,  5.50batch/s]Predicting:  29%|██▉       | 158/549 [00:41<01:17,  5.02batch/s]Predicting:  29%|██▉       | 159/549 [00:42<01:17,  5.02batch/s]Predicting:  29%|██▉       | 160/549 [00:42<01:12,  5.39batch/s]Predicting:  29%|██▉       | 161/549 [00:42<01:17,  5.01batch/s]Predicting:  30%|██▉       | 162/549 [00:42<01:08,  5.69batch/s]Predicting:  30%|██▉       | 163/549 [00:42<01:02,  6.22batch/s]Predicting:  30%|██▉       | 164/549 [00:42<00:58,  6.58batch/s]Predicting:  30%|███       | 165/549 [00:42<00:52,  7.26batch/s]Predicting:  30%|███       | 166/549 [00:43<00:52,  7.36batch/s]Predicting:  30%|███       | 167/549 [00:43<00:58,  6.56batch/s]Predicting:  31%|███       | 168/549 [00:43<01:05,  5.81batch/s]Predicting:  31%|███       | 169/549 [00:43<01:11,  5.29batch/s]Predicting:  31%|███       | 170/549 [00:43<01:15,  5.04batch/s]Predicting:  31%|███       | 171/549 [00:44<01:15,  5.03batch/s]Predicting:  31%|███▏      | 172/549 [00:44<01:18,  4.80batch/s]Predicting:  32%|███▏      | 173/549 [00:44<01:06,  5.62batch/s]Predicting:  32%|███▏      | 174/549 [00:44<01:01,  6.09batch/s]Predicting:  32%|███▏      | 175/549 [00:44<01:00,  6.21batch/s]Predicting:  32%|███▏      | 176/549 [00:44<01:05,  5.71batch/s]Predicting:  32%|███▏      | 177/549 [00:45<01:10,  5.28batch/s]Predicting:  32%|███▏      | 178/549 [00:45<01:14,  5.01batch/s]Predicting:  33%|███▎      | 179/549 [00:45<01:11,  5.17batch/s]Predicting:  33%|███▎      | 180/549 [00:45<01:04,  5.72batch/s]Predicting:  33%|███▎      | 181/549 [00:45<01:01,  6.03batch/s]Predicting:  33%|███▎      | 182/549 [00:46<01:04,  5.73batch/s]Predicting:  33%|███▎      | 183/549 [00:46<01:08,  5.36batch/s]Predicting:  34%|███▎      | 184/549 [00:46<01:02,  5.84batch/s]Predicting:  34%|███▎      | 185/549 [00:46<00:55,  6.59batch/s]Predicting:  34%|███▍      | 186/549 [00:46<00:59,  6.15batch/s]Predicting:  34%|███▍      | 187/549 [00:46<01:04,  5.65batch/s]Predicting:  34%|███▍      | 188/549 [00:47<01:06,  5.45batch/s]Predicting:  34%|███▍      | 189/549 [00:47<00:57,  6.24batch/s]Predicting:  35%|███▍      | 190/549 [00:47<00:55,  6.43batch/s]Predicting:  35%|███▍      | 191/549 [00:47<00:50,  7.10batch/s]Predicting:  35%|███▍      | 192/549 [00:47<01:00,  5.93batch/s]Predicting:  35%|███▌      | 193/549 [00:47<00:59,  6.01batch/s]Predicting:  35%|███▌      | 194/549 [00:47<00:52,  6.75batch/s]Predicting:  36%|███▌      | 195/549 [00:48<00:53,  6.58batch/s]Predicting:  36%|███▌      | 196/549 [00:48<00:48,  7.23batch/s]Predicting:  36%|███▌      | 197/549 [00:48<00:47,  7.38batch/s]Predicting:  36%|███▌      | 198/549 [00:48<00:57,  6.13batch/s]Predicting:  36%|███▌      | 199/549 [00:48<01:05,  5.37batch/s]Predicting:  36%|███▋      | 200/549 [00:48<01:03,  5.47batch/s]Predicting:  37%|███▋      | 201/549 [00:49<00:55,  6.25batch/s]Predicting:  37%|███▋      | 202/549 [00:49<00:55,  6.26batch/s]Predicting:  37%|███▋      | 203/549 [00:49<00:59,  5.83batch/s]Predicting:  37%|███▋      | 204/549 [00:49<00:53,  6.42batch/s]Predicting:  37%|███▋      | 205/549 [00:49<01:00,  5.71batch/s]Predicting:  38%|███▊      | 206/549 [00:49<01:00,  5.71batch/s]Predicting:  38%|███▊      | 207/549 [00:50<00:58,  5.81batch/s]Predicting:  38%|███▊      | 208/549 [00:50<00:52,  6.48batch/s]Predicting:  38%|███▊      | 209/549 [00:50<00:59,  5.69batch/s]Predicting:  38%|███▊      | 210/549 [00:50<01:04,  5.23batch/s]Predicting:  38%|███▊      | 211/549 [00:50<01:02,  5.38batch/s]Predicting:  39%|███▉      | 213/549 [00:51<00:57,  5.89batch/s]Predicting:  39%|███▉      | 214/549 [00:51<00:52,  6.44batch/s]Predicting:  39%|███▉      | 216/549 [00:51<00:48,  6.93batch/s]Predicting:  40%|███▉      | 217/549 [00:51<00:55,  6.03batch/s]Predicting:  40%|███▉      | 218/549 [00:51<00:54,  6.11batch/s]Predicting:  40%|███▉      | 219/549 [00:52<00:56,  5.86batch/s]Predicting:  40%|████      | 220/549 [00:52<01:01,  5.34batch/s]Predicting:  40%|████      | 222/549 [00:52<00:47,  6.95batch/s]Predicting:  41%|████      | 223/549 [00:52<00:45,  7.15batch/s]Predicting:  41%|████      | 224/549 [00:52<00:52,  6.16batch/s]Predicting:  41%|████      | 225/549 [00:53<00:59,  5.48batch/s]Predicting:  41%|████      | 226/549 [00:53<01:01,  5.25batch/s]Predicting:  41%|████▏     | 227/549 [00:53<00:55,  5.82batch/s]Predicting:  42%|████▏     | 228/549 [00:53<00:49,  6.52batch/s]Predicting:  42%|████▏     | 229/549 [00:53<00:50,  6.40batch/s]Predicting:  42%|████▏     | 230/549 [00:53<00:54,  5.82batch/s]Predicting:  42%|████▏     | 231/549 [00:54<01:03,  5.01batch/s]Predicting:  42%|████▏     | 232/549 [00:54<00:54,  5.77batch/s]Predicting:  42%|████▏     | 233/549 [00:54<00:51,  6.12batch/s]Predicting:  43%|████▎     | 234/549 [00:54<00:50,  6.24batch/s]Predicting:  43%|████▎     | 235/549 [00:54<00:57,  5.48batch/s]Predicting:  43%|████▎     | 236/549 [00:55<01:01,  5.12batch/s]Predicting:  43%|████▎     | 237/549 [00:55<01:02,  5.02batch/s]Predicting:  43%|████▎     | 238/549 [00:55<00:56,  5.50batch/s]Predicting:  44%|████▎     | 239/549 [00:55<01:01,  5.06batch/s]Predicting:  44%|████▎     | 240/549 [00:55<00:55,  5.60batch/s]Predicting:  44%|████▍     | 241/549 [00:55<00:49,  6.23batch/s]Predicting:  44%|████▍     | 242/549 [00:55<00:44,  6.92batch/s]Predicting:  44%|████▍     | 244/549 [00:56<00:36,  8.37batch/s]Predicting:  45%|████▍     | 245/549 [00:56<00:38,  7.82batch/s]Predicting:  45%|████▍     | 246/549 [00:56<00:45,  6.61batch/s]Predicting:  45%|████▍     | 247/549 [00:56<00:53,  5.62batch/s]Predicting:  45%|████▌     | 248/549 [00:56<00:47,  6.33batch/s]Predicting:  45%|████▌     | 249/549 [00:57<00:51,  5.80batch/s]Predicting:  46%|████▌     | 250/549 [00:57<00:55,  5.36batch/s]Predicting:  46%|████▌     | 251/549 [00:57<00:57,  5.20batch/s]Predicting:  46%|████▌     | 252/549 [00:57<01:01,  4.85batch/s]Predicting:  46%|████▌     | 253/549 [00:57<00:57,  5.17batch/s]Predicting:  46%|████▋     | 254/549 [00:58<00:50,  5.79batch/s]Predicting:  46%|████▋     | 255/549 [00:58<00:45,  6.52batch/s]Predicting:  47%|████▋     | 256/549 [00:58<00:50,  5.78batch/s]Predicting:  47%|████▋     | 257/549 [00:58<00:52,  5.59batch/s]Predicting:  47%|████▋     | 258/549 [00:58<00:55,  5.22batch/s]Predicting:  47%|████▋     | 260/549 [00:59<00:45,  6.36batch/s]Predicting:  48%|████▊     | 261/549 [00:59<00:45,  6.34batch/s]Predicting:  48%|████▊     | 262/549 [00:59<00:48,  5.93batch/s]Predicting:  48%|████▊     | 263/549 [00:59<00:48,  5.84batch/s]Predicting:  48%|████▊     | 264/549 [00:59<00:44,  6.42batch/s]Predicting:  48%|████▊     | 265/549 [00:59<00:44,  6.32batch/s]Predicting:  48%|████▊     | 266/549 [01:00<00:51,  5.54batch/s]Predicting:  49%|████▊     | 267/549 [01:00<00:47,  5.95batch/s]Predicting:  49%|████▉     | 268/549 [01:00<00:48,  5.85batch/s]Predicting:  49%|████▉     | 269/549 [01:00<00:48,  5.73batch/s]Predicting:  49%|████▉     | 271/549 [01:00<00:36,  7.66batch/s]Predicting:  50%|████▉     | 272/549 [01:00<00:35,  7.70batch/s]Predicting:  50%|████▉     | 273/549 [01:01<00:41,  6.73batch/s]Predicting:  50%|████▉     | 274/549 [01:01<00:37,  7.32batch/s]Predicting:  50%|█████     | 275/549 [01:01<00:42,  6.39batch/s]Predicting:  50%|█████     | 276/549 [01:01<00:48,  5.66batch/s]Predicting:  50%|█████     | 277/549 [01:01<00:50,  5.38batch/s]Predicting:  51%|█████     | 279/549 [01:01<00:38,  7.02batch/s]Predicting:  51%|█████     | 280/549 [01:02<00:40,  6.69batch/s]Predicting:  51%|█████     | 281/549 [01:02<00:41,  6.39batch/s]Predicting:  51%|█████▏    | 282/549 [01:02<00:45,  5.84batch/s]Predicting:  52%|█████▏    | 283/549 [01:02<00:48,  5.53batch/s]Predicting:  52%|█████▏    | 284/549 [01:02<00:45,  5.79batch/s]Predicting:  52%|█████▏    | 285/549 [01:03<00:43,  6.11batch/s]Predicting:  52%|█████▏    | 286/549 [01:03<00:45,  5.81batch/s]Predicting:  52%|█████▏    | 287/549 [01:03<00:39,  6.56batch/s]Predicting:  52%|█████▏    | 288/549 [01:03<00:43,  5.94batch/s]Predicting:  53%|█████▎    | 289/549 [01:03<00:47,  5.46batch/s]Predicting:  53%|█████▎    | 290/549 [01:03<00:43,  5.89batch/s]Predicting:  53%|█████▎    | 291/549 [01:04<00:45,  5.61batch/s]Predicting:  53%|█████▎    | 292/549 [01:04<00:45,  5.63batch/s]Predicting:  54%|█████▎    | 294/549 [01:04<00:36,  7.01batch/s]Predicting:  54%|█████▎    | 295/549 [01:04<00:39,  6.38batch/s]Predicting:  54%|█████▍    | 296/549 [01:04<00:39,  6.38batch/s]Predicting:  54%|█████▍    | 297/549 [01:04<00:37,  6.78batch/s]Predicting:  54%|█████▍    | 298/549 [01:05<00:42,  5.88batch/s]Predicting:  54%|█████▍    | 299/549 [01:05<00:40,  6.19batch/s]Predicting:  55%|█████▍    | 300/549 [01:05<00:40,  6.20batch/s]Predicting:  55%|█████▍    | 301/549 [01:05<00:37,  6.64batch/s]Predicting:  55%|█████▌    | 302/549 [01:05<00:34,  7.24batch/s]Predicting:  55%|█████▌    | 303/549 [01:05<00:31,  7.72batch/s]Predicting:  55%|█████▌    | 304/549 [01:06<00:39,  6.28batch/s]Predicting:  56%|█████▌    | 305/549 [01:06<00:35,  6.86batch/s]Predicting:  56%|█████▌    | 306/549 [01:06<00:35,  6.90batch/s]Predicting:  56%|█████▌    | 307/549 [01:06<00:39,  6.06batch/s]Predicting:  56%|█████▌    | 308/549 [01:06<00:42,  5.65batch/s]Predicting:  56%|█████▋    | 309/549 [01:06<00:46,  5.21batch/s]Predicting:  56%|█████▋    | 310/549 [01:07<00:47,  5.03batch/s]Predicting:  57%|█████▋    | 311/549 [01:07<00:43,  5.47batch/s]Predicting:  57%|█████▋    | 313/549 [01:07<00:34,  6.77batch/s]Predicting:  57%|█████▋    | 314/549 [01:07<00:32,  7.33batch/s]Predicting:  57%|█████▋    | 315/549 [01:07<00:30,  7.79batch/s]Predicting:  58%|█████▊    | 316/549 [01:07<00:34,  6.74batch/s]Predicting:  58%|█████▊    | 317/549 [01:08<00:38,  6.10batch/s]Predicting:  58%|█████▊    | 318/549 [01:08<00:41,  5.62batch/s]Predicting:  58%|█████▊    | 319/549 [01:08<00:38,  5.92batch/s]Predicting:  58%|█████▊    | 320/549 [01:08<00:41,  5.48batch/s]Predicting:  58%|█████▊    | 321/549 [01:08<00:39,  5.80batch/s]Predicting:  59%|█████▊    | 322/549 [01:09<00:40,  5.62batch/s]Predicting:  59%|█████▉    | 323/549 [01:09<00:38,  5.85batch/s]Predicting:  59%|█████▉    | 324/549 [01:09<00:39,  5.63batch/s]Predicting:  59%|█████▉    | 325/549 [01:09<00:39,  5.67batch/s]Predicting:  60%|█████▉    | 327/549 [01:09<00:30,  7.36batch/s]Predicting:  60%|█████▉    | 328/549 [01:09<00:32,  6.82batch/s]Predicting:  60%|█████▉    | 329/549 [01:10<00:36,  5.99batch/s]Predicting:  60%|██████    | 330/549 [01:10<00:36,  5.93batch/s]Predicting:  60%|██████    | 331/549 [01:10<00:40,  5.44batch/s]Predicting:  60%|██████    | 332/549 [01:10<00:39,  5.54batch/s]Predicting:  61%|██████    | 333/549 [01:10<00:34,  6.31batch/s]Predicting:  61%|██████    | 334/549 [01:11<00:37,  5.81batch/s]Predicting:  61%|██████    | 335/549 [01:11<00:37,  5.70batch/s]Predicting:  61%|██████    | 336/549 [01:11<00:32,  6.48batch/s]Predicting:  61%|██████▏   | 337/549 [01:11<00:29,  7.16batch/s]Predicting:  62%|██████▏   | 338/549 [01:11<00:27,  7.54batch/s]Predicting:  62%|██████▏   | 339/549 [01:11<00:26,  8.05batch/s]Predicting:  62%|██████▏   | 340/549 [01:11<00:31,  6.60batch/s]Predicting:  62%|██████▏   | 341/549 [01:12<00:36,  5.75batch/s]Predicting:  62%|██████▏   | 342/549 [01:12<00:40,  5.11batch/s]Predicting:  62%|██████▏   | 343/549 [01:12<00:41,  4.99batch/s]Predicting:  63%|██████▎   | 344/549 [01:12<00:39,  5.18batch/s]Predicting:  63%|██████▎   | 345/549 [01:12<00:36,  5.55batch/s]Predicting:  63%|██████▎   | 346/549 [01:13<00:35,  5.78batch/s]Predicting:  63%|██████▎   | 347/549 [01:13<00:33,  6.09batch/s]Predicting:  63%|██████▎   | 348/549 [01:13<00:29,  6.82batch/s]Predicting:  64%|██████▎   | 349/549 [01:13<00:27,  7.15batch/s]Predicting:  64%|██████▍   | 350/549 [01:13<00:29,  6.85batch/s]Predicting:  64%|██████▍   | 352/549 [01:13<00:27,  7.13batch/s]Predicting:  64%|██████▍   | 353/549 [01:14<00:31,  6.21batch/s]Predicting:  64%|██████▍   | 354/549 [01:14<00:33,  5.88batch/s]Predicting:  65%|██████▍   | 355/549 [01:14<00:35,  5.40batch/s]Predicting:  65%|██████▍   | 356/549 [01:14<00:35,  5.50batch/s]Predicting:  65%|██████▌   | 357/549 [01:14<00:35,  5.46batch/s]Predicting:  65%|██████▌   | 358/549 [01:14<00:32,  5.81batch/s]Predicting:  65%|██████▌   | 359/549 [01:15<00:33,  5.72batch/s]Predicting:  66%|██████▌   | 360/549 [01:15<00:30,  6.14batch/s]Predicting:  66%|██████▌   | 361/549 [01:15<00:28,  6.55batch/s]Predicting:  66%|██████▌   | 362/549 [01:15<00:26,  6.95batch/s]Predicting:  66%|██████▌   | 363/549 [01:15<00:31,  5.81batch/s]Predicting:  66%|██████▋   | 364/549 [01:16<00:33,  5.54batch/s]Predicting:  66%|██████▋   | 365/549 [01:16<00:33,  5.57batch/s]Predicting:  67%|██████▋   | 366/549 [01:16<00:29,  6.15batch/s]Predicting:  67%|██████▋   | 367/549 [01:16<00:26,  6.87batch/s]Predicting:  67%|██████▋   | 368/549 [01:16<00:30,  5.89batch/s]Predicting:  67%|██████▋   | 369/549 [01:16<00:31,  5.63batch/s]Predicting:  67%|██████▋   | 370/549 [01:16<00:27,  6.40batch/s]Predicting:  68%|██████▊   | 371/549 [01:17<00:29,  6.03batch/s]Predicting:  68%|██████▊   | 372/549 [01:17<00:27,  6.48batch/s]Predicting:  68%|██████▊   | 373/549 [01:17<00:29,  5.94batch/s]Predicting:  68%|██████▊   | 374/549 [01:17<00:28,  6.18batch/s]Predicting:  68%|██████▊   | 375/549 [01:17<00:30,  5.69batch/s]Predicting:  68%|██████▊   | 376/549 [01:18<00:31,  5.54batch/s]Predicting:  69%|██████▊   | 377/549 [01:18<00:29,  5.84batch/s]Predicting:  69%|██████▉   | 378/549 [01:18<00:27,  6.11batch/s]Predicting:  69%|██████▉   | 379/549 [01:18<00:27,  6.19batch/s]Predicting:  69%|██████▉   | 380/549 [01:18<00:30,  5.58batch/s]Predicting:  69%|██████▉   | 381/549 [01:18<00:26,  6.36batch/s]Predicting:  70%|██████▉   | 382/549 [01:18<00:29,  5.75batch/s]Predicting:  70%|██████▉   | 383/549 [01:19<00:29,  5.67batch/s]Predicting:  70%|██████▉   | 384/549 [01:19<00:25,  6.45batch/s]Predicting:  70%|███████   | 385/549 [01:19<00:22,  7.15batch/s]Predicting:  70%|███████   | 386/549 [01:19<00:24,  6.58batch/s]Predicting:  70%|███████   | 387/549 [01:19<00:27,  5.88batch/s]Predicting:  71%|███████   | 389/549 [01:19<00:21,  7.34batch/s]Predicting:  71%|███████   | 390/549 [01:20<00:25,  6.23batch/s]Predicting:  71%|███████   | 391/549 [01:20<00:26,  5.97batch/s]Predicting:  71%|███████▏  | 392/549 [01:20<00:25,  6.12batch/s]Predicting:  72%|███████▏  | 393/549 [01:20<00:23,  6.57batch/s]Predicting:  72%|███████▏  | 394/549 [01:20<00:26,  5.95batch/s]Predicting:  72%|███████▏  | 395/549 [01:21<00:23,  6.43batch/s]Predicting:  72%|███████▏  | 396/549 [01:21<00:21,  7.08batch/s]Predicting:  72%|███████▏  | 397/549 [01:21<00:25,  5.94batch/s]Predicting:  72%|███████▏  | 398/549 [01:21<00:27,  5.51batch/s]Predicting:  73%|███████▎  | 399/549 [01:21<00:27,  5.52batch/s]Predicting:  73%|███████▎  | 400/549 [01:21<00:27,  5.40batch/s]Predicting:  73%|███████▎  | 401/549 [01:22<00:28,  5.20batch/s]Predicting:  73%|███████▎  | 402/549 [01:22<00:24,  6.02batch/s]Predicting:  73%|███████▎  | 403/549 [01:22<00:22,  6.53batch/s]Predicting:  74%|███████▎  | 404/549 [01:22<00:22,  6.33batch/s]Predicting:  74%|███████▍  | 405/549 [01:22<00:24,  5.83batch/s]Predicting:  74%|███████▍  | 406/549 [01:22<00:27,  5.24batch/s]Predicting:  74%|███████▍  | 407/549 [01:23<00:26,  5.30batch/s]Predicting:  74%|███████▍  | 408/549 [01:23<00:23,  5.91batch/s]Predicting:  74%|███████▍  | 409/549 [01:23<00:21,  6.66batch/s]Predicting:  75%|███████▍  | 410/549 [01:23<00:23,  6.04batch/s]Predicting:  75%|███████▍  | 411/549 [01:23<00:24,  5.68batch/s]Predicting:  75%|███████▌  | 412/549 [01:23<00:25,  5.43batch/s]Predicting:  75%|███████▌  | 413/549 [01:24<00:21,  6.19batch/s]Predicting:  75%|███████▌  | 414/549 [01:24<00:19,  6.84batch/s]Predicting:  76%|███████▌  | 415/549 [01:24<00:18,  7.40batch/s]Predicting:  76%|███████▌  | 417/549 [01:24<00:13,  9.96batch/s]Predicting:  76%|███████▋  | 419/549 [01:24<00:16,  7.96batch/s]Predicting:  77%|███████▋  | 420/549 [01:24<00:18,  6.94batch/s]Predicting:  77%|███████▋  | 421/549 [01:25<00:22,  5.71batch/s]Predicting:  77%|███████▋  | 422/549 [01:25<00:20,  6.14batch/s]Predicting:  77%|███████▋  | 423/549 [01:25<00:18,  6.79batch/s]Predicting:  77%|███████▋  | 424/549 [01:25<00:19,  6.32batch/s]Predicting:  77%|███████▋  | 425/549 [01:25<00:21,  5.87batch/s]Predicting:  78%|███████▊  | 426/549 [01:26<00:22,  5.46batch/s]Predicting:  78%|███████▊  | 427/549 [01:26<00:19,  6.17batch/s]Predicting:  78%|███████▊  | 428/549 [01:26<00:17,  6.87batch/s]Predicting:  78%|███████▊  | 429/549 [01:26<00:16,  7.49batch/s]Predicting:  78%|███████▊  | 430/549 [01:26<00:14,  8.01batch/s]Predicting:  79%|███████▊  | 431/549 [01:26<00:16,  7.06batch/s]Predicting:  79%|███████▊  | 432/549 [01:26<00:18,  6.39batch/s]Predicting:  79%|███████▉  | 434/549 [01:27<00:14,  8.07batch/s]Predicting:  79%|███████▉  | 435/549 [01:27<00:15,  7.50batch/s]Predicting:  79%|███████▉  | 436/549 [01:27<00:18,  6.16batch/s]Predicting:  80%|███████▉  | 437/549 [01:27<00:19,  5.73batch/s]Predicting:  80%|███████▉  | 439/549 [01:27<00:16,  6.58batch/s]Predicting:  80%|████████  | 440/549 [01:28<00:19,  5.46batch/s]Predicting:  80%|████████  | 441/549 [01:28<00:19,  5.42batch/s]Predicting:  81%|████████  | 442/549 [01:28<00:19,  5.40batch/s]Predicting:  81%|████████  | 443/549 [01:28<00:18,  5.84batch/s]Predicting:  81%|████████  | 444/549 [01:28<00:17,  5.89batch/s]Predicting:  81%|████████  | 445/549 [01:28<00:15,  6.64batch/s]Predicting:  81%|████████  | 446/549 [01:29<00:14,  7.30batch/s]Predicting:  81%|████████▏ | 447/549 [01:29<00:13,  7.83batch/s]Predicting:  82%|████████▏ | 448/549 [01:29<00:15,  6.52batch/s]Predicting:  82%|████████▏ | 449/549 [01:29<00:17,  5.81batch/s]Predicting:  82%|████████▏ | 450/549 [01:29<00:16,  5.95batch/s]Predicting:  82%|████████▏ | 451/549 [01:29<00:14,  6.53batch/s]Predicting:  82%|████████▏ | 452/549 [01:30<00:17,  5.57batch/s]Predicting:  83%|████████▎ | 453/549 [01:30<00:17,  5.46batch/s]Predicting:  83%|████████▎ | 454/549 [01:30<00:15,  6.25batch/s]Predicting:  83%|████████▎ | 455/549 [01:30<00:13,  6.72batch/s]Predicting:  83%|████████▎ | 456/549 [01:30<00:15,  5.85batch/s]Predicting:  83%|████████▎ | 457/549 [01:30<00:15,  5.92batch/s]Predicting:  83%|████████▎ | 458/549 [01:31<00:16,  5.61batch/s]Predicting:  84%|████████▎ | 459/549 [01:31<00:17,  5.17batch/s]Predicting:  84%|████████▍ | 460/549 [01:31<00:15,  5.78batch/s]Predicting:  84%|████████▍ | 461/549 [01:31<00:14,  6.02batch/s]Predicting:  84%|████████▍ | 462/549 [01:31<00:13,  6.25batch/s]Predicting:  84%|████████▍ | 463/549 [01:31<00:14,  5.73batch/s]Predicting:  85%|████████▍ | 464/549 [01:32<00:13,  6.52batch/s]Predicting:  85%|████████▍ | 465/549 [01:32<00:11,  7.19batch/s]Predicting:  85%|████████▍ | 466/549 [01:32<00:11,  7.47batch/s]Predicting:  85%|████████▌ | 467/549 [01:32<00:12,  6.80batch/s]Predicting:  85%|████████▌ | 468/549 [01:32<00:11,  7.27batch/s]Predicting:  85%|████████▌ | 469/549 [01:32<00:13,  6.01batch/s]Predicting:  86%|████████▌ | 470/549 [01:33<00:14,  5.37batch/s]Predicting:  86%|████████▌ | 471/549 [01:33<00:13,  5.70batch/s]Predicting:  86%|████████▌ | 473/549 [01:33<00:10,  7.45batch/s]Predicting:  86%|████████▋ | 474/549 [01:33<00:09,  7.87batch/s]Predicting:  87%|████████▋ | 475/549 [01:33<00:09,  7.77batch/s]Predicting:  87%|████████▋ | 476/549 [01:33<00:10,  7.25batch/s]Predicting:  87%|████████▋ | 477/549 [01:34<00:11,  6.19batch/s]Predicting:  87%|████████▋ | 478/549 [01:34<00:11,  5.92batch/s]Predicting:  87%|████████▋ | 479/549 [01:34<00:12,  5.41batch/s]Predicting:  87%|████████▋ | 480/549 [01:34<00:12,  5.74batch/s]Predicting:  88%|████████▊ | 481/549 [01:34<00:12,  5.29batch/s]Predicting:  88%|████████▊ | 482/549 [01:35<00:13,  5.02batch/s]Predicting:  88%|████████▊ | 483/549 [01:35<00:11,  5.84batch/s]Predicting:  88%|████████▊ | 484/549 [01:35<00:09,  6.61batch/s]Predicting:  88%|████████▊ | 485/549 [01:35<00:08,  7.27batch/s]Predicting:  89%|████████▊ | 486/549 [01:35<00:09,  6.43batch/s]Predicting:  89%|████████▊ | 487/549 [01:35<00:10,  5.69batch/s]Predicting:  89%|████████▉ | 488/549 [01:35<00:09,  6.48batch/s]Predicting:  89%|████████▉ | 489/549 [01:36<00:10,  5.67batch/s]Predicting:  89%|████████▉ | 490/549 [01:36<00:11,  5.34batch/s]Predicting:  89%|████████▉ | 491/549 [01:36<00:11,  5.04batch/s]Predicting:  90%|████████▉ | 493/549 [01:36<00:08,  6.91batch/s]Predicting:  90%|████████▉ | 494/549 [01:36<00:07,  7.41batch/s]Predicting:  90%|█████████ | 495/549 [01:36<00:06,  7.85batch/s]Predicting:  90%|█████████ | 496/549 [01:37<00:07,  7.31batch/s]Predicting:  91%|█████████ | 497/549 [01:37<00:08,  5.94batch/s]Predicting:  91%|█████████ | 498/549 [01:37<00:08,  5.96batch/s]Predicting:  91%|█████████ | 499/549 [01:37<00:08,  5.64batch/s]Predicting:  91%|█████████ | 500/549 [01:37<00:07,  6.22batch/s]Predicting:  91%|█████████▏| 501/549 [01:37<00:06,  6.93batch/s]Predicting:  91%|█████████▏| 502/549 [01:38<00:07,  6.39batch/s]Predicting:  92%|█████████▏| 503/549 [01:38<00:07,  6.47batch/s]Predicting:  92%|█████████▏| 504/549 [01:38<00:07,  6.14batch/s]Predicting:  92%|█████████▏| 505/549 [01:38<00:07,  6.21batch/s]Predicting:  92%|█████████▏| 506/549 [01:38<00:07,  6.00batch/s]Predicting:  92%|█████████▏| 507/549 [01:38<00:06,  6.09batch/s]Predicting:  93%|█████████▎| 508/549 [01:39<00:05,  6.84batch/s]Predicting:  93%|█████████▎| 509/549 [01:39<00:05,  7.48batch/s]Predicting:  93%|█████████▎| 510/549 [01:39<00:06,  6.46batch/s]Predicting:  93%|█████████▎| 511/549 [01:39<00:06,  5.74batch/s]Predicting:  93%|█████████▎| 512/549 [01:39<00:05,  6.37batch/s]Predicting:  93%|█████████▎| 513/549 [01:39<00:05,  6.84batch/s]Predicting:  94%|█████████▎| 514/549 [01:39<00:05,  6.83batch/s]Predicting:  94%|█████████▍| 516/549 [01:40<00:04,  6.60batch/s]Predicting:  94%|█████████▍| 517/549 [01:40<00:05,  5.79batch/s]Predicting:  94%|█████████▍| 518/549 [01:40<00:05,  5.60batch/s]Predicting:  95%|█████████▍| 519/549 [01:40<00:04,  6.29batch/s]Predicting:  95%|█████████▍| 520/549 [01:40<00:04,  6.51batch/s]Predicting:  95%|█████████▍| 521/549 [01:41<00:03,  7.16batch/s]Predicting:  95%|█████████▌| 522/549 [01:41<00:03,  7.24batch/s]Predicting:  95%|█████████▌| 523/549 [01:41<00:04,  6.30batch/s]Predicting:  95%|█████████▌| 524/549 [01:41<00:04,  5.68batch/s]Predicting:  96%|█████████▌| 525/549 [01:41<00:03,  6.08batch/s]Predicting:  96%|█████████▌| 526/549 [01:41<00:03,  6.33batch/s]Predicting:  96%|█████████▌| 527/549 [01:42<00:03,  6.94batch/s]Predicting:  96%|█████████▋| 529/549 [01:42<00:02,  9.10batch/s]Predicting:  97%|█████████▋| 531/549 [01:42<00:01, 10.83batch/s]Predicting:  97%|█████████▋| 533/549 [01:42<00:01, 12.09batch/s]Predicting:  97%|█████████▋| 535/549 [01:42<00:01, 13.04batch/s]Predicting:  98%|█████████▊| 537/549 [01:42<00:00, 13.68batch/s]Predicting:  98%|█████████▊| 539/549 [01:42<00:00, 14.13batch/s]Predicting:  99%|█████████▊| 541/549 [01:42<00:00, 14.49batch/s]Predicting:  99%|█████████▉| 543/549 [01:43<00:00, 14.73batch/s]Predicting:  99%|█████████▉| 545/549 [01:43<00:00, 14.88batch/s]Predicting: 100%|█████████▉| 547/549 [01:43<00:00, 15.04batch/s]Predicting: 100%|██████████| 549/549 [01:43<00:00, 15.10batch/s]Predicting: 100%|██████████| 549/549 [01:43<00:00,  5.28batch/s]
INFO:state._cli._tx._predict:Creating anndatas from predictions from manual loop...
... storing 'target_gene' as categorical
... storing 'cell_type' as categorical
... storing 'batch_var' as categorical
... storing 'ctrl_cell_barcode' as categorical
... storing 'target_gene' as categorical
... storing 'cell_type' as categorical
... storing 'batch_var' as categorical
... storing 'ctrl_cell_barcode' as categorical
INFO:state._cli._tx._predict:Saved adata_pred to checkpoints/forth_run20251202/eval_step=10700.ckpt/adata_pred.h5ad
INFO:state._cli._tx._predict:Saved adata_real to checkpoints/forth_run20251202/eval_step=10700.ckpt/adata_real.h5ad
INFO:state._cli._tx._predict:Computing metrics using cell-eval...
WARNING:cell_eval._evaluator:Output directory checkpoints/forth_run20251202/eval_step=10700.ckpt already exists, potential overwrite occurring
INFO:cell_eval.utils:Data appears to be log1p normalized (decimals detected, range [0.00, 7.60])
INFO:cell_eval._evaluator:Input is found to be log-normalized already - skipping transformation.
INFO:cell_eval.utils:Data appears to be log1p normalized (decimals detected, range [0.00, 9.66])
INFO:cell_eval._evaluator:Input is found to be log-normalized already - skipping transformation.
INFO:cell_eval._evaluator:Computing DE for real data
INFO:cell_eval._evaluator:Using the following pdex kwargs: {'exp_post_agg': True, 'is_log1p': True, 'reference': 'non-targeting', 'groupby_key': 'target_gene', 'num_workers': 48, 'batch_size': 2048, 'metric': 'wilcoxon', 'as_polars': True}
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/31 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 31/31 [00:00<00:00, 8765.82it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 2735086.79it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=560480
INFO:pdex._single_cell:Creating generator of all batches: N=274
INFO:pdex._single_cell:Initializing parallel processing pool
Traceback (most recent call last):
  File "/public/home/CS286/qiyt2023-CS286/miniconda3/envs/CellPerturb_VCC_Proj6_STATE2/bin/state", line 7, in <module>
    sys.exit(main())
  File "/public/home/CS286/qiyt2023-CS286/CellPerturb_VCC_Proj6_new4/STATE/src/state/__main__.py", line 123, in main
    run_tx_predict(args)
  File "/public/home/CS286/qiyt2023-CS286/CellPerturb_VCC_Proj6_new4/STATE/src/state/_cli/_tx/_predict.py", line 416, in run_tx_predict
    evaluator = MetricsEvaluator(
  File "/public/home/CS286/qiyt2023-CS286/miniconda3/envs/CellPerturb_VCC_Proj6_STATE2/lib/python3.10/site-packages/cell_eval/_evaluator.py", line 95, in __init__
    self.de_comparison = _build_de_comparison(
  File "/public/home/CS286/qiyt2023-CS286/miniconda3/envs/CellPerturb_VCC_Proj6_STATE2/lib/python3.10/site-packages/cell_eval/_evaluator.py", line 232, in _build_de_comparison
    real=_load_or_build_de(
  File "/public/home/CS286/qiyt2023-CS286/miniconda3/envs/CellPerturb_VCC_Proj6_STATE2/lib/python3.10/site-packages/cell_eval/_evaluator.py", line 316, in _load_or_build_de
    frame = parallel_differential_expression(
  File "/public/home/CS286/qiyt2023-CS286/miniconda3/envs/CellPerturb_VCC_Proj6_STATE2/lib/python3.10/site-packages/pdex/_single_cell.py", line 415, in parallel_differential_expression
    with mp.Pool(num_workers) as pool:
  File "/public/home/CS286/qiyt2023-CS286/miniconda3/envs/CellPerturb_VCC_Proj6_STATE2/lib/python3.10/multiprocessing/context.py", line 119, in Pool
    return Pool(processes, initializer, initargs, maxtasksperchild,
  File "/public/home/CS286/qiyt2023-CS286/miniconda3/envs/CellPerturb_VCC_Proj6_STATE2/lib/python3.10/multiprocessing/pool.py", line 215, in __init__
    self._repopulate_pool()
  File "/public/home/CS286/qiyt2023-CS286/miniconda3/envs/CellPerturb_VCC_Proj6_STATE2/lib/python3.10/multiprocessing/pool.py", line 306, in _repopulate_pool
    return self._repopulate_pool_static(self._ctx, self.Process,
  File "/public/home/CS286/qiyt2023-CS286/miniconda3/envs/CellPerturb_VCC_Proj6_STATE2/lib/python3.10/multiprocessing/pool.py", line 329, in _repopulate_pool_static
    w.start()
  File "/public/home/CS286/qiyt2023-CS286/miniconda3/envs/CellPerturb_VCC_Proj6_STATE2/lib/python3.10/multiprocessing/process.py", line 121, in start
    self._popen = self._Popen(self)
  File "/public/home/CS286/qiyt2023-CS286/miniconda3/envs/CellPerturb_VCC_Proj6_STATE2/lib/python3.10/multiprocessing/context.py", line 281, in _Popen
    return Popen(process_obj)
  File "/public/home/CS286/qiyt2023-CS286/miniconda3/envs/CellPerturb_VCC_Proj6_STATE2/lib/python3.10/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
  File "/public/home/CS286/qiyt2023-CS286/miniconda3/envs/CellPerturb_VCC_Proj6_STATE2/lib/python3.10/multiprocessing/popen_fork.py", line 66, in _launch
    self.pid = os.fork()
OSError: [Errno 12] Cannot allocate memory
/public/home/CS286/qiyt2023-CS286/miniconda3/envs/CellPerturb_VCC_Proj6_STATE2/lib/python3.10/multiprocessing/resource_tracker.py:224: UserWarning: resource_tracker: There appear to be 1 leaked shared_memory objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
