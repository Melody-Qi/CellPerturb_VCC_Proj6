INFO:state._cli._tx._predict:Loaded config from checkpoints/forth_run20251202/config.yaml
INFO:cell_load.data_modules.perturbation_dataloader:Loaded data module configuration from ./checkpoints/forth_run20251202/data_module.torch
INFO:cell_load.config:Configuration validation passed
INFO:cell_load.data_modules.perturbation_dataloader:Initializing DataModule: batch_size=16, workers=12, random_seed=42
INFO:cell_load.data_modules.perturbation_dataloader:Set 2 missing perturbations to zero vectors.
INFO:cell_load.data_modules.perturbation_dataloader:Loaded custom perturbation featurizations for 19792 perturbations.
INFO:cell_load.data_modules.perturbation_dataloader:Processing dataset vcc:
INFO:cell_load.data_modules.perturbation_dataloader:  - Training dataset: True
INFO:cell_load.data_modules.perturbation_dataloader:  - Zeroshot cell types: []
INFO:cell_load.data_modules.perturbation_dataloader:  - Fewshot cell types: ['ARC_H1']
Processing vcc:   0%|          | 0/1 [00:00<?, ?it/s]                                                     Processing vcc:   0%|          | 0/1 [00:00<?, ?it/s]Processing vcc: 100%|██████████| 1/1 [00:00<00:00,  2.56it/s]Processing vcc: 100%|██████████| 1/1 [00:00<00:00,  2.55it/s]
INFO:cell_load.data_modules.perturbation_dataloader:

INFO:cell_load.data_modules.perturbation_dataloader:Done! Train / Val / Test splits: 1 / 1 / 1
INFO:state._cli._tx._predict:Loaded data module from ./checkpoints/forth_run20251202/data_module.torch
[rank: 0] Seed set to 42
INFO:state._cli._tx._predict:Loading model from ./checkpoints/forth_run20251202/checkpoints/step=step=22000-val_loss=val_loss=0.9084.ckpt
INFO:state._cli._tx._predict:Model loaded successfully.
INFO:cell_load.data_modules.samplers:Creating perturbation batch sampler with metadata caching (using codes)...
INFO:cell_load.data_modules.samplers:Total # cells 68271. Cell set size mean / std before resampling: 124.36 / 17.58.
INFO:cell_load.data_modules.samplers:Creating meta-batches with cell_sentence_len=128...
INFO:cell_load.data_modules.samplers:Of all batches, 549 were full and 0 were partial.
INFO:cell_load.data_modules.samplers:Sampler created with 549 batches in 0.03 seconds.
INFO:state._cli._tx._predict:Generating predictions on test set using manual loop...
Predicting:   0%|          | 0/549 [00:00<?, ?batch/s]INFO:cell_load.data_modules.samplers:Of all batches, 549 were full and 0 were partial.
Predicting:   0%|          | 1/549 [00:11<1:46:04, 11.61s/batch]Predicting:   0%|          | 2/549 [00:11<44:28,  4.88s/batch]  Predicting:   1%|          | 3/549 [00:11<24:32,  2.70s/batch]Predicting:   1%|          | 5/549 [00:12<11:05,  1.22s/batch]Predicting:   1%|▏         | 7/549 [00:12<06:29,  1.39batch/s]Predicting:   1%|▏         | 8/549 [00:12<05:11,  1.74batch/s]Predicting:   2%|▏         | 9/549 [00:12<04:05,  2.20batch/s]Predicting:   2%|▏         | 10/549 [00:12<03:15,  2.75batch/s]Predicting:   2%|▏         | 12/549 [00:12<02:12,  4.06batch/s]Predicting:   2%|▏         | 13/549 [00:13<04:04,  2.19batch/s]Predicting:   3%|▎         | 14/549 [00:14<03:20,  2.67batch/s]Predicting:   3%|▎         | 15/549 [00:14<02:42,  3.28batch/s]Predicting:   3%|▎         | 17/549 [00:14<01:53,  4.70batch/s]Predicting:   3%|▎         | 18/549 [00:14<01:39,  5.35batch/s]Predicting:   3%|▎         | 19/549 [00:14<01:27,  6.03batch/s]Predicting:   4%|▍         | 21/549 [00:14<01:14,  7.13batch/s]Predicting:   4%|▍         | 22/549 [00:14<01:11,  7.39batch/s]Predicting:   4%|▍         | 23/549 [00:15<01:09,  7.59batch/s]Predicting:   5%|▍         | 25/549 [00:16<03:56,  2.22batch/s]Predicting:   5%|▍         | 26/549 [00:17<03:48,  2.29batch/s]Predicting:   5%|▍         | 27/549 [00:17<03:11,  2.73batch/s]Predicting:   5%|▌         | 28/549 [00:17<02:45,  3.16batch/s]Predicting:   5%|▌         | 29/549 [00:17<02:27,  3.52batch/s]Predicting:   5%|▌         | 30/549 [00:17<02:07,  4.08batch/s]Predicting:   6%|▌         | 31/549 [00:18<01:54,  4.50batch/s]Predicting:   6%|▌         | 32/549 [00:18<01:58,  4.38batch/s]Predicting:   6%|▌         | 33/549 [00:18<01:49,  4.72batch/s]Predicting:   6%|▋         | 35/549 [00:18<01:34,  5.41batch/s]Predicting:   7%|▋         | 36/549 [00:18<01:27,  5.87batch/s]Predicting:   7%|▋         | 37/549 [00:19<03:00,  2.83batch/s]Predicting:   7%|▋         | 38/549 [00:20<03:11,  2.67batch/s]Predicting:   7%|▋         | 39/549 [00:20<02:33,  3.31batch/s]Predicting:   7%|▋         | 40/549 [00:20<02:08,  3.95batch/s]Predicting:   7%|▋         | 41/549 [00:20<02:06,  4.02batch/s]Predicting:   8%|▊         | 42/549 [00:21<02:19,  3.65batch/s]Predicting:   8%|▊         | 43/549 [00:21<02:05,  4.02batch/s]Predicting:   8%|▊         | 44/549 [00:21<02:01,  4.15batch/s]Predicting:   8%|▊         | 45/549 [00:21<01:56,  4.34batch/s]Predicting:   8%|▊         | 46/549 [00:21<02:10,  3.85batch/s]Predicting:   9%|▊         | 47/549 [00:22<02:36,  3.21batch/s]Predicting:   9%|▊         | 48/549 [00:22<02:56,  2.84batch/s]Predicting:   9%|▉         | 49/549 [00:23<02:41,  3.09batch/s]Predicting:   9%|▉         | 50/549 [00:23<02:31,  3.29batch/s]Predicting:   9%|▉         | 51/549 [00:23<02:20,  3.54batch/s]Predicting:   9%|▉         | 52/549 [00:23<02:21,  3.52batch/s]Predicting:  10%|▉         | 53/549 [00:24<02:18,  3.58batch/s]Predicting:  10%|▉         | 54/549 [00:24<02:23,  3.45batch/s]Predicting:  10%|█         | 55/549 [00:24<02:06,  3.91batch/s]Predicting:  10%|█         | 56/549 [00:24<02:18,  3.57batch/s]Predicting:  10%|█         | 57/549 [00:25<02:15,  3.63batch/s]Predicting:  11%|█         | 58/549 [00:25<02:06,  3.88batch/s]Predicting:  11%|█         | 59/549 [00:25<02:14,  3.64batch/s]Predicting:  11%|█         | 60/549 [00:26<02:31,  3.22batch/s]Predicting:  11%|█         | 61/549 [00:26<02:44,  2.97batch/s]Predicting:  11%|█▏        | 62/549 [00:26<02:29,  3.25batch/s]Predicting:  11%|█▏        | 63/549 [00:26<02:03,  3.94batch/s]Predicting:  12%|█▏        | 64/549 [00:27<01:43,  4.67batch/s]Predicting:  12%|█▏        | 66/549 [00:27<01:20,  5.98batch/s]Predicting:  12%|█▏        | 67/549 [00:27<01:29,  5.36batch/s]Predicting:  12%|█▏        | 68/549 [00:27<01:23,  5.76batch/s]Predicting:  13%|█▎        | 69/549 [00:27<01:22,  5.81batch/s]Predicting:  13%|█▎        | 70/549 [00:27<01:21,  5.87batch/s]Predicting:  13%|█▎        | 71/549 [00:28<01:28,  5.39batch/s]Predicting:  13%|█▎        | 72/549 [00:28<01:35,  5.00batch/s]Predicting:  13%|█▎        | 73/549 [00:28<01:51,  4.27batch/s]Predicting:  13%|█▎        | 74/549 [00:29<01:57,  4.06batch/s]Predicting:  14%|█▎        | 75/549 [00:29<01:45,  4.50batch/s]Predicting:  14%|█▍        | 76/549 [00:29<02:07,  3.71batch/s]Predicting:  14%|█▍        | 77/549 [00:29<01:59,  3.97batch/s]Predicting:  14%|█▍        | 78/549 [00:30<02:00,  3.92batch/s]Predicting:  14%|█▍        | 79/549 [00:30<01:52,  4.19batch/s]Predicting:  15%|█▍        | 80/549 [00:30<01:55,  4.06batch/s]Predicting:  15%|█▍        | 81/549 [00:30<01:41,  4.63batch/s]Predicting:  15%|█▍        | 82/549 [00:30<01:31,  5.09batch/s]Predicting:  15%|█▌        | 83/549 [00:31<01:32,  5.06batch/s]Predicting:  15%|█▌        | 84/549 [00:31<01:43,  4.47batch/s]Predicting:  15%|█▌        | 85/549 [00:31<01:45,  4.39batch/s]Predicting:  16%|█▌        | 86/549 [00:31<01:38,  4.72batch/s]Predicting:  16%|█▌        | 87/549 [00:31<01:29,  5.18batch/s]Predicting:  16%|█▌        | 88/549 [00:32<01:34,  4.86batch/s]Predicting:  16%|█▋        | 90/549 [00:32<01:27,  5.22batch/s]Predicting:  17%|█▋        | 91/549 [00:32<01:37,  4.69batch/s]Predicting:  17%|█▋        | 92/549 [00:32<01:27,  5.22batch/s]Predicting:  17%|█▋        | 93/549 [00:33<01:31,  4.98batch/s]Predicting:  17%|█▋        | 94/549 [00:33<01:40,  4.51batch/s]Predicting:  17%|█▋        | 95/549 [00:33<01:33,  4.87batch/s]Predicting:  17%|█▋        | 96/549 [00:33<01:22,  5.48batch/s]Predicting:  18%|█▊        | 97/549 [00:33<01:28,  5.09batch/s]Predicting:  18%|█▊        | 98/549 [00:33<01:19,  5.66batch/s]Predicting:  18%|█▊        | 99/549 [00:34<01:33,  4.80batch/s]Predicting:  18%|█▊        | 100/549 [00:34<01:45,  4.27batch/s]Predicting:  18%|█▊        | 101/549 [00:34<01:28,  5.07batch/s]Predicting:  19%|█▊        | 102/549 [00:34<01:25,  5.26batch/s]Predicting:  19%|█▉        | 103/549 [00:35<01:30,  4.95batch/s]Predicting:  19%|█▉        | 104/549 [00:35<01:33,  4.78batch/s]Predicting:  19%|█▉        | 105/549 [00:35<01:24,  5.25batch/s]Predicting:  19%|█▉        | 106/549 [00:35<01:22,  5.34batch/s]Predicting:  19%|█▉        | 107/549 [00:35<01:12,  6.08batch/s]Predicting:  20%|█▉        | 108/549 [00:36<01:25,  5.17batch/s]Predicting:  20%|█▉        | 109/549 [00:36<01:43,  4.26batch/s]Predicting:  20%|██        | 110/549 [00:36<01:36,  4.57batch/s]Predicting:  20%|██        | 111/549 [00:36<01:38,  4.46batch/s]Predicting:  20%|██        | 112/549 [00:36<01:33,  4.65batch/s]Predicting:  21%|██        | 113/549 [00:37<01:36,  4.54batch/s]Predicting:  21%|██        | 114/549 [00:37<01:40,  4.35batch/s]Predicting:  21%|██        | 115/549 [00:37<01:40,  4.32batch/s]Predicting:  21%|██▏       | 117/549 [00:37<01:08,  6.29batch/s]Predicting:  21%|██▏       | 118/549 [00:37<01:03,  6.81batch/s]Predicting:  22%|██▏       | 119/549 [00:38<01:00,  7.16batch/s]Predicting:  22%|██▏       | 120/549 [00:38<01:11,  6.03batch/s]Predicting:  22%|██▏       | 121/549 [00:38<01:27,  4.91batch/s]Predicting:  22%|██▏       | 122/549 [00:38<01:43,  4.13batch/s]Predicting:  22%|██▏       | 123/549 [00:39<01:29,  4.75batch/s]Predicting:  23%|██▎       | 124/549 [00:39<01:19,  5.33batch/s]Predicting:  23%|██▎       | 125/549 [00:39<01:24,  5.03batch/s]Predicting:  23%|██▎       | 126/549 [00:39<01:29,  4.71batch/s]Predicting:  23%|██▎       | 127/549 [00:39<01:31,  4.63batch/s]Predicting:  23%|██▎       | 128/549 [00:40<01:27,  4.81batch/s]Predicting:  23%|██▎       | 129/549 [00:40<01:25,  4.93batch/s]Predicting:  24%|██▎       | 130/549 [00:40<01:25,  4.92batch/s]Predicting:  24%|██▍       | 131/549 [00:40<01:25,  4.89batch/s]Predicting:  24%|██▍       | 132/549 [00:40<01:27,  4.74batch/s]Predicting:  24%|██▍       | 133/549 [00:41<01:27,  4.73batch/s]Predicting:  24%|██▍       | 134/549 [00:41<01:21,  5.11batch/s]Predicting:  25%|██▍       | 135/549 [00:41<01:24,  4.90batch/s]Predicting:  25%|██▍       | 136/549 [00:41<01:23,  4.97batch/s]Predicting:  25%|██▍       | 137/549 [00:41<01:27,  4.71batch/s]Predicting:  25%|██▌       | 138/549 [00:42<01:28,  4.66batch/s]Predicting:  25%|██▌       | 139/549 [00:42<01:15,  5.41batch/s]Predicting:  26%|██▌       | 140/549 [00:42<01:20,  5.08batch/s]Predicting:  26%|██▌       | 141/549 [00:42<01:28,  4.62batch/s]Predicting:  26%|██▌       | 142/549 [00:42<01:22,  4.91batch/s]Predicting:  26%|██▌       | 143/549 [00:43<01:18,  5.18batch/s]Predicting:  26%|██▌       | 144/549 [00:43<01:23,  4.88batch/s]Predicting:  26%|██▋       | 145/549 [00:43<01:21,  4.94batch/s]Predicting:  27%|██▋       | 146/549 [00:43<01:11,  5.65batch/s]Predicting:  27%|██▋       | 147/549 [00:43<01:14,  5.41batch/s]Predicting:  27%|██▋       | 148/549 [00:44<01:10,  5.70batch/s]Predicting:  27%|██▋       | 149/549 [00:44<01:13,  5.42batch/s]Predicting:  27%|██▋       | 150/549 [00:44<01:03,  6.28batch/s]Predicting:  28%|██▊       | 151/549 [00:44<01:11,  5.60batch/s]Predicting:  28%|██▊       | 152/549 [00:44<01:15,  5.24batch/s]Predicting:  28%|██▊       | 153/549 [00:44<01:14,  5.32batch/s]Predicting:  28%|██▊       | 154/549 [00:45<01:19,  4.99batch/s]Predicting:  28%|██▊       | 155/549 [00:45<01:23,  4.70batch/s]Predicting:  28%|██▊       | 156/549 [00:45<01:13,  5.33batch/s]Predicting:  29%|██▊       | 157/549 [00:45<01:19,  4.94batch/s]Predicting:  29%|██▉       | 158/549 [00:46<01:26,  4.52batch/s]Predicting:  29%|██▉       | 159/549 [00:46<01:27,  4.47batch/s]Predicting:  29%|██▉       | 160/549 [00:46<01:14,  5.19batch/s]Predicting:  29%|██▉       | 161/549 [00:46<01:08,  5.66batch/s]Predicting:  30%|██▉       | 162/549 [00:46<01:18,  4.95batch/s]Predicting:  30%|██▉       | 163/549 [00:46<01:16,  5.05batch/s]Predicting:  30%|██▉       | 164/549 [00:47<01:17,  4.94batch/s]Predicting:  30%|███       | 165/549 [00:47<01:16,  5.02batch/s]Predicting:  30%|███       | 166/549 [00:47<01:18,  4.88batch/s]Predicting:  30%|███       | 167/549 [00:47<01:20,  4.76batch/s]Predicting:  31%|███       | 168/549 [00:47<01:09,  5.50batch/s]Predicting:  31%|███       | 169/549 [00:48<01:00,  6.32batch/s]Predicting:  31%|███       | 170/549 [00:48<00:54,  7.02batch/s]Predicting:  31%|███       | 171/549 [00:48<00:56,  6.65batch/s]Predicting:  31%|███▏      | 172/549 [00:48<01:06,  5.64batch/s]Predicting:  32%|███▏      | 173/549 [00:48<01:14,  5.07batch/s]Predicting:  32%|███▏      | 174/549 [00:49<01:19,  4.73batch/s]Predicting:  32%|███▏      | 175/549 [00:49<01:19,  4.71batch/s]Predicting:  32%|███▏      | 176/549 [00:49<01:17,  4.79batch/s]Predicting:  32%|███▏      | 177/549 [00:49<01:13,  5.05batch/s]Predicting:  32%|███▏      | 178/549 [00:49<01:08,  5.45batch/s]Predicting:  33%|███▎      | 179/549 [00:49<01:04,  5.77batch/s]Predicting:  33%|███▎      | 180/549 [00:50<01:01,  6.03batch/s]Predicting:  33%|███▎      | 181/549 [00:50<01:05,  5.60batch/s]Predicting:  33%|███▎      | 182/549 [00:50<01:10,  5.23batch/s]Predicting:  33%|███▎      | 183/549 [00:50<01:13,  4.95batch/s]Predicting:  34%|███▎      | 185/549 [00:50<00:55,  6.54batch/s]Predicting:  34%|███▍      | 186/549 [00:51<00:51,  7.07batch/s]Predicting:  34%|███▍      | 187/549 [00:51<01:00,  6.00batch/s]Predicting:  34%|███▍      | 188/549 [00:51<01:01,  5.84batch/s]Predicting:  34%|███▍      | 189/549 [00:51<00:55,  6.45batch/s]Predicting:  35%|███▍      | 190/549 [00:51<01:07,  5.35batch/s]Predicting:  35%|███▍      | 191/549 [00:52<01:11,  4.99batch/s]Predicting:  35%|███▍      | 192/549 [00:52<01:13,  4.88batch/s]Predicting:  35%|███▌      | 193/549 [00:52<01:12,  4.91batch/s]Predicting:  35%|███▌      | 194/549 [00:52<01:14,  4.74batch/s]Predicting:  36%|███▌      | 195/549 [00:52<01:06,  5.29batch/s]Predicting:  36%|███▌      | 196/549 [00:52<00:58,  6.09batch/s]Predicting:  36%|███▌      | 197/549 [00:53<00:59,  5.87batch/s]Predicting:  36%|███▌      | 198/549 [00:53<01:02,  5.62batch/s]Predicting:  36%|███▌      | 199/549 [00:53<01:05,  5.33batch/s]Predicting:  36%|███▋      | 200/549 [00:53<00:59,  5.90batch/s]Predicting:  37%|███▋      | 201/549 [00:53<00:52,  6.59batch/s]Predicting:  37%|███▋      | 202/549 [00:53<00:57,  6.07batch/s]Predicting:  37%|███▋      | 203/549 [00:54<00:54,  6.35batch/s]Predicting:  37%|███▋      | 204/549 [00:54<01:07,  5.14batch/s]Predicting:  37%|███▋      | 205/549 [00:54<01:08,  5.00batch/s]Predicting:  38%|███▊      | 206/549 [00:54<01:10,  4.84batch/s]Predicting:  38%|███▊      | 207/549 [00:55<01:11,  4.78batch/s]Predicting:  38%|███▊      | 208/549 [00:55<01:01,  5.54batch/s]Predicting:  38%|███▊      | 209/549 [00:55<01:07,  5.03batch/s]Predicting:  38%|███▊      | 210/549 [00:55<01:11,  4.72batch/s]Predicting:  38%|███▊      | 211/549 [00:55<01:02,  5.44batch/s]Predicting:  39%|███▉      | 213/549 [00:55<00:46,  7.28batch/s]Predicting:  39%|███▉      | 214/549 [00:56<00:43,  7.69batch/s]Predicting:  39%|███▉      | 215/549 [00:56<00:52,  6.35batch/s]Predicting:  39%|███▉      | 216/549 [00:56<01:03,  5.25batch/s]Predicting:  40%|███▉      | 217/549 [00:56<01:06,  4.98batch/s]Predicting:  40%|███▉      | 218/549 [00:56<01:07,  4.88batch/s]Predicting:  40%|███▉      | 219/549 [00:57<01:00,  5.46batch/s]Predicting:  40%|████      | 220/549 [00:57<01:03,  5.22batch/s]Predicting:  40%|████      | 221/549 [00:57<00:57,  5.70batch/s]Predicting:  40%|████      | 222/549 [00:57<01:02,  5.27batch/s]Predicting:  41%|████      | 223/549 [00:57<01:00,  5.35batch/s]Predicting:  41%|████      | 224/549 [00:58<01:07,  4.81batch/s]Predicting:  41%|████      | 225/549 [00:58<01:00,  5.36batch/s]Predicting:  41%|████      | 226/549 [00:58<00:59,  5.41batch/s]Predicting:  41%|████▏     | 227/549 [00:58<00:53,  5.98batch/s]Predicting:  42%|████▏     | 228/549 [00:58<00:54,  5.86batch/s]Predicting:  42%|████▏     | 229/549 [00:58<00:54,  5.88batch/s]Predicting:  42%|████▏     | 230/549 [00:59<00:51,  6.16batch/s]Predicting:  42%|████▏     | 231/549 [00:59<00:56,  5.59batch/s]Predicting:  42%|████▏     | 232/549 [00:59<01:00,  5.21batch/s]Predicting:  42%|████▏     | 233/549 [00:59<00:56,  5.55batch/s]Predicting:  43%|████▎     | 234/549 [00:59<00:53,  5.88batch/s]Predicting:  43%|████▎     | 235/549 [01:00<00:59,  5.31batch/s]Predicting:  43%|████▎     | 236/549 [01:00<00:53,  5.85batch/s]Predicting:  43%|████▎     | 237/549 [01:00<01:00,  5.17batch/s]Predicting:  43%|████▎     | 238/549 [01:00<01:00,  5.12batch/s]Predicting:  44%|████▎     | 239/549 [01:00<00:53,  5.84batch/s]Predicting:  44%|████▎     | 240/549 [01:00<00:52,  5.85batch/s]Predicting:  44%|████▍     | 241/549 [01:01<00:57,  5.38batch/s]Predicting:  44%|████▍     | 242/549 [01:01<00:54,  5.58batch/s]Predicting:  44%|████▍     | 243/549 [01:01<00:55,  5.49batch/s]Predicting:  44%|████▍     | 244/549 [01:01<00:58,  5.25batch/s]Predicting:  45%|████▍     | 245/549 [01:01<00:50,  6.03batch/s]Predicting:  45%|████▍     | 246/549 [01:01<00:44,  6.76batch/s]Predicting:  45%|████▍     | 247/549 [01:02<00:48,  6.18batch/s]Predicting:  45%|████▌     | 248/549 [01:02<01:01,  4.87batch/s]Predicting:  45%|████▌     | 249/549 [01:02<00:55,  5.37batch/s]Predicting:  46%|████▌     | 250/549 [01:02<00:50,  5.88batch/s]Predicting:  46%|████▌     | 251/549 [01:02<00:45,  6.57batch/s]Predicting:  46%|████▌     | 252/549 [01:02<00:43,  6.77batch/s]Predicting:  46%|████▌     | 253/549 [01:03<00:52,  5.60batch/s]Predicting:  46%|████▋     | 254/549 [01:03<00:58,  5.07batch/s]Predicting:  46%|████▋     | 255/549 [01:03<01:00,  4.82batch/s]Predicting:  47%|████▋     | 256/549 [01:03<00:58,  5.05batch/s]Predicting:  47%|████▋     | 257/549 [01:04<01:02,  4.65batch/s]Predicting:  47%|████▋     | 258/549 [01:04<01:03,  4.60batch/s]Predicting:  47%|████▋     | 259/549 [01:04<01:04,  4.52batch/s]Predicting:  47%|████▋     | 260/549 [01:04<01:02,  4.62batch/s]Predicting:  48%|████▊     | 261/549 [01:04<01:02,  4.62batch/s]Predicting:  48%|████▊     | 262/549 [01:05<01:03,  4.53batch/s]Predicting:  48%|████▊     | 263/549 [01:05<00:56,  5.02batch/s]Predicting:  48%|████▊     | 265/549 [01:05<00:42,  6.72batch/s]Predicting:  48%|████▊     | 266/549 [01:05<00:46,  6.09batch/s]Predicting:  49%|████▊     | 267/549 [01:05<00:44,  6.34batch/s]Predicting:  49%|████▉     | 268/549 [01:06<00:44,  6.26batch/s]Predicting:  49%|████▉     | 269/549 [01:06<00:53,  5.25batch/s]Predicting:  49%|████▉     | 270/549 [01:06<00:54,  5.15batch/s]Predicting:  49%|████▉     | 271/549 [01:06<00:55,  5.04batch/s]Predicting:  50%|████▉     | 272/549 [01:06<00:59,  4.67batch/s]Predicting:  50%|████▉     | 273/549 [01:07<00:54,  5.11batch/s]Predicting:  50%|████▉     | 274/549 [01:07<00:51,  5.37batch/s]Predicting:  50%|█████     | 275/549 [01:07<00:47,  5.77batch/s]Predicting:  50%|█████     | 276/549 [01:07<00:43,  6.24batch/s]Predicting:  50%|█████     | 277/549 [01:07<00:47,  5.76batch/s]Predicting:  51%|█████     | 278/549 [01:07<00:49,  5.46batch/s]Predicting:  51%|█████     | 279/549 [01:08<00:54,  4.98batch/s]Predicting:  51%|█████     | 280/549 [01:08<00:55,  4.88batch/s]Predicting:  51%|█████     | 281/549 [01:08<00:52,  5.10batch/s]Predicting:  52%|█████▏    | 283/549 [01:08<00:39,  6.72batch/s]Predicting:  52%|█████▏    | 284/549 [01:09<00:44,  6.01batch/s]Predicting:  52%|█████▏    | 285/549 [01:09<00:47,  5.51batch/s]Predicting:  52%|█████▏    | 286/549 [01:09<00:47,  5.49batch/s]Predicting:  52%|█████▏    | 287/549 [01:09<00:42,  6.22batch/s]Predicting:  52%|█████▏    | 288/549 [01:09<00:40,  6.42batch/s]Predicting:  53%|█████▎    | 289/549 [01:09<00:50,  5.18batch/s]Predicting:  53%|█████▎    | 290/549 [01:10<00:50,  5.14batch/s]Predicting:  53%|█████▎    | 291/549 [01:10<00:52,  4.95batch/s]Predicting:  53%|█████▎    | 292/549 [01:10<00:53,  4.84batch/s]Predicting:  54%|█████▎    | 294/549 [01:10<00:44,  5.71batch/s]Predicting:  54%|█████▎    | 295/549 [01:11<00:47,  5.35batch/s]Predicting:  54%|█████▍    | 296/549 [01:11<00:48,  5.18batch/s]Predicting:  54%|█████▍    | 297/549 [01:11<00:42,  5.91batch/s]Predicting:  54%|█████▍    | 298/549 [01:11<00:38,  6.60batch/s]Predicting:  54%|█████▍    | 299/549 [01:11<00:43,  5.75batch/s]Predicting:  55%|█████▍    | 300/549 [01:11<00:46,  5.37batch/s]Predicting:  55%|█████▍    | 301/549 [01:12<00:47,  5.20batch/s]Predicting:  55%|█████▌    | 302/549 [01:12<00:44,  5.59batch/s]Predicting:  55%|█████▌    | 303/549 [01:12<00:38,  6.35batch/s]Predicting:  55%|█████▌    | 304/549 [01:12<00:41,  5.94batch/s]Predicting:  56%|█████▌    | 305/549 [01:12<00:37,  6.43batch/s]Predicting:  56%|█████▌    | 306/549 [01:12<00:38,  6.26batch/s]Predicting:  56%|█████▌    | 307/549 [01:13<00:40,  5.97batch/s]Predicting:  56%|█████▌    | 308/549 [01:13<00:44,  5.42batch/s]Predicting:  56%|█████▋    | 309/549 [01:13<00:45,  5.22batch/s]Predicting:  56%|█████▋    | 310/549 [01:13<00:47,  5.07batch/s]Predicting:  57%|█████▋    | 311/549 [01:13<00:42,  5.63batch/s]Predicting:  57%|█████▋    | 312/549 [01:13<00:37,  6.38batch/s]Predicting:  57%|█████▋    | 313/549 [01:14<00:37,  6.36batch/s]Predicting:  57%|█████▋    | 314/549 [01:14<00:39,  5.88batch/s]Predicting:  57%|█████▋    | 315/549 [01:14<00:39,  5.86batch/s]Predicting:  58%|█████▊    | 317/549 [01:14<00:36,  6.40batch/s]Predicting:  58%|█████▊    | 318/549 [01:14<00:33,  6.91batch/s]Predicting:  58%|█████▊    | 319/549 [01:15<00:37,  6.09batch/s]Predicting:  58%|█████▊    | 320/549 [01:15<00:40,  5.62batch/s]Predicting:  58%|█████▊    | 321/549 [01:15<00:42,  5.33batch/s]Predicting:  59%|█████▊    | 322/549 [01:15<00:44,  5.08batch/s]Predicting:  59%|█████▉    | 323/549 [01:15<00:40,  5.57batch/s]Predicting:  59%|█████▉    | 324/549 [01:16<00:36,  6.19batch/s]Predicting:  59%|█████▉    | 325/549 [01:16<00:36,  6.18batch/s]Predicting:  60%|█████▉    | 327/549 [01:16<00:30,  7.31batch/s]Predicting:  60%|█████▉    | 328/549 [01:16<00:35,  6.28batch/s]Predicting:  60%|█████▉    | 329/549 [01:16<00:38,  5.64batch/s]Predicting:  60%|██████    | 330/549 [01:17<00:41,  5.32batch/s]Predicting:  60%|██████    | 331/549 [01:17<00:36,  6.05batch/s]Predicting:  60%|██████    | 332/549 [01:17<00:37,  5.78batch/s]Predicting:  61%|██████    | 333/549 [01:17<00:38,  5.66batch/s]Predicting:  61%|██████    | 334/549 [01:17<00:34,  6.16batch/s]Predicting:  61%|██████    | 335/549 [01:17<00:31,  6.80batch/s]Predicting:  61%|██████    | 336/549 [01:17<00:28,  7.40batch/s]Predicting:  61%|██████▏   | 337/549 [01:18<00:34,  6.08batch/s]Predicting:  62%|██████▏   | 338/549 [01:18<00:32,  6.50batch/s]Predicting:  62%|██████▏   | 339/549 [01:18<00:35,  5.92batch/s]Predicting:  62%|██████▏   | 340/549 [01:18<00:38,  5.42batch/s]Predicting:  62%|██████▏   | 341/549 [01:18<00:42,  4.92batch/s]Predicting:  62%|██████▏   | 342/549 [01:19<00:42,  4.82batch/s]Predicting:  62%|██████▏   | 343/549 [01:19<00:39,  5.27batch/s]Predicting:  63%|██████▎   | 344/549 [01:19<00:42,  4.86batch/s]Predicting:  63%|██████▎   | 345/549 [01:19<00:42,  4.77batch/s]Predicting:  63%|██████▎   | 346/549 [01:19<00:43,  4.64batch/s]Predicting:  63%|██████▎   | 347/549 [01:20<00:40,  4.93batch/s]Predicting:  63%|██████▎   | 348/549 [01:20<00:36,  5.51batch/s]Predicting:  64%|██████▎   | 349/549 [01:20<00:39,  5.03batch/s]Predicting:  64%|██████▍   | 350/549 [01:20<00:35,  5.58batch/s]Predicting:  64%|██████▍   | 352/549 [01:20<00:31,  6.20batch/s]Predicting:  64%|██████▍   | 353/549 [01:21<00:33,  5.78batch/s]Predicting:  64%|██████▍   | 354/549 [01:21<00:35,  5.47batch/s]Predicting:  65%|██████▍   | 355/549 [01:21<00:34,  5.67batch/s]Predicting:  65%|██████▍   | 356/549 [01:21<00:31,  6.22batch/s]Predicting:  65%|██████▌   | 357/549 [01:21<00:35,  5.45batch/s]Predicting:  65%|██████▌   | 358/549 [01:22<00:37,  5.14batch/s]Predicting:  65%|██████▌   | 359/549 [01:22<00:36,  5.27batch/s]Predicting:  66%|██████▌   | 360/549 [01:22<00:35,  5.27batch/s]Predicting:  66%|██████▌   | 361/549 [01:22<00:31,  5.97batch/s]Predicting:  66%|██████▌   | 362/549 [01:22<00:31,  5.93batch/s]Predicting:  66%|██████▌   | 363/549 [01:22<00:31,  5.82batch/s]Predicting:  66%|██████▋   | 364/549 [01:23<00:29,  6.31batch/s]Predicting:  66%|██████▋   | 365/549 [01:23<00:28,  6.37batch/s]Predicting:  67%|██████▋   | 366/549 [01:23<00:26,  6.88batch/s]Predicting:  67%|██████▋   | 367/549 [01:23<00:31,  5.86batch/s]Predicting:  67%|██████▋   | 368/549 [01:23<00:33,  5.48batch/s]Predicting:  67%|██████▋   | 369/549 [01:24<00:36,  4.96batch/s]Predicting:  67%|██████▋   | 370/549 [01:24<00:33,  5.38batch/s]Predicting:  68%|██████▊   | 371/549 [01:24<00:31,  5.60batch/s]Predicting:  68%|██████▊   | 372/549 [01:24<00:29,  6.05batch/s]Predicting:  68%|██████▊   | 373/549 [01:24<00:32,  5.36batch/s]Predicting:  68%|██████▊   | 374/549 [01:24<00:29,  5.87batch/s]Predicting:  68%|██████▊   | 375/549 [01:24<00:29,  5.95batch/s]Predicting:  68%|██████▊   | 376/549 [01:25<00:33,  5.18batch/s]Predicting:  69%|██████▊   | 377/549 [01:25<00:29,  5.75batch/s]Predicting:  69%|██████▉   | 378/549 [01:25<00:26,  6.51batch/s]Predicting:  69%|██████▉   | 379/549 [01:25<00:24,  6.86batch/s]Predicting:  69%|██████▉   | 380/549 [01:25<00:23,  7.13batch/s]Predicting:  69%|██████▉   | 381/549 [01:25<00:27,  6.02batch/s]Predicting:  70%|██████▉   | 382/549 [01:26<00:29,  5.59batch/s]Predicting:  70%|██████▉   | 383/549 [01:26<00:28,  5.77batch/s]Predicting:  70%|██████▉   | 384/549 [01:26<00:29,  5.69batch/s]Predicting:  70%|███████   | 385/549 [01:26<00:28,  5.70batch/s]Predicting:  70%|███████   | 386/549 [01:26<00:34,  4.75batch/s]Predicting:  70%|███████   | 387/549 [01:27<00:31,  5.19batch/s]Predicting:  71%|███████   | 389/549 [01:27<00:23,  6.89batch/s]Predicting:  71%|███████   | 390/549 [01:27<00:27,  5.76batch/s]Predicting:  71%|███████   | 391/549 [01:27<00:29,  5.38batch/s]Predicting:  71%|███████▏  | 392/549 [01:28<00:30,  5.14batch/s]Predicting:  72%|███████▏  | 393/549 [01:28<00:31,  5.02batch/s]Predicting:  72%|███████▏  | 394/549 [01:28<00:26,  5.76batch/s]Predicting:  72%|███████▏  | 395/549 [01:28<00:28,  5.33batch/s]Predicting:  72%|███████▏  | 396/549 [01:28<00:29,  5.25batch/s]Predicting:  72%|███████▏  | 397/549 [01:28<00:28,  5.42batch/s]Predicting:  72%|███████▏  | 398/549 [01:29<00:29,  5.10batch/s]Predicting:  73%|███████▎  | 399/549 [01:29<00:28,  5.17batch/s]Predicting:  73%|███████▎  | 400/549 [01:29<00:25,  5.76batch/s]Predicting:  73%|███████▎  | 401/549 [01:29<00:24,  6.13batch/s]Predicting:  73%|███████▎  | 402/549 [01:29<00:21,  6.79batch/s]Predicting:  73%|███████▎  | 403/549 [01:29<00:21,  6.79batch/s]Predicting:  74%|███████▎  | 404/549 [01:29<00:19,  7.37batch/s]Predicting:  74%|███████▍  | 405/549 [01:30<00:24,  5.90batch/s]Predicting:  74%|███████▍  | 406/549 [01:30<00:27,  5.29batch/s]Predicting:  74%|███████▍  | 407/549 [01:30<00:30,  4.69batch/s]Predicting:  74%|███████▍  | 408/549 [01:30<00:29,  4.84batch/s]Predicting:  74%|███████▍  | 409/549 [01:31<00:30,  4.54batch/s]Predicting:  75%|███████▍  | 410/549 [01:31<00:27,  4.99batch/s]Predicting:  75%|███████▍  | 411/549 [01:31<00:23,  5.81batch/s]Predicting:  75%|███████▌  | 412/549 [01:31<00:21,  6.29batch/s]Predicting:  75%|███████▌  | 413/549 [01:31<00:19,  6.98batch/s]Predicting:  75%|███████▌  | 414/549 [01:31<00:19,  7.02batch/s]Predicting:  76%|███████▌  | 417/549 [01:32<00:17,  7.74batch/s]Predicting:  76%|███████▌  | 418/549 [01:32<00:19,  6.80batch/s]Predicting:  76%|███████▋  | 419/549 [01:32<00:21,  6.06batch/s]Predicting:  77%|███████▋  | 420/549 [01:32<00:22,  5.66batch/s]Predicting:  77%|███████▋  | 421/549 [01:32<00:20,  6.28batch/s]Predicting:  77%|███████▋  | 422/549 [01:33<00:22,  5.53batch/s]Predicting:  77%|███████▋  | 423/549 [01:33<00:24,  5.18batch/s]Predicting:  77%|███████▋  | 424/549 [01:33<00:25,  4.99batch/s]Predicting:  77%|███████▋  | 425/549 [01:33<00:25,  4.83batch/s]Predicting:  78%|███████▊  | 426/549 [01:33<00:22,  5.47batch/s]Predicting:  78%|███████▊  | 427/549 [01:34<00:21,  5.80batch/s]Predicting:  78%|███████▊  | 428/549 [01:34<00:23,  5.09batch/s]Predicting:  78%|███████▊  | 429/549 [01:34<00:20,  5.77batch/s]Predicting:  78%|███████▊  | 430/549 [01:34<00:22,  5.40batch/s]Predicting:  79%|███████▊  | 431/549 [01:34<00:23,  4.99batch/s]Predicting:  79%|███████▊  | 432/549 [01:35<00:22,  5.29batch/s]Predicting:  79%|███████▉  | 434/549 [01:35<00:19,  5.87batch/s]Predicting:  79%|███████▉  | 435/549 [01:35<00:19,  5.76batch/s]Predicting:  79%|███████▉  | 436/549 [01:35<00:17,  6.36batch/s]Predicting:  80%|███████▉  | 437/549 [01:35<00:17,  6.36batch/s]Predicting:  80%|███████▉  | 439/549 [01:36<00:16,  6.60batch/s]Predicting:  80%|████████  | 440/549 [01:36<00:18,  5.74batch/s]Predicting:  80%|████████  | 441/549 [01:36<00:20,  5.28batch/s]Predicting:  81%|████████  | 442/549 [01:36<00:21,  5.08batch/s]Predicting:  81%|████████  | 443/549 [01:36<00:19,  5.45batch/s]Predicting:  81%|████████  | 444/549 [01:37<00:19,  5.50batch/s]Predicting:  81%|████████  | 445/549 [01:37<00:17,  6.01batch/s]Predicting:  81%|████████  | 446/549 [01:37<00:15,  6.70batch/s]Predicting:  81%|████████▏ | 447/549 [01:37<00:13,  7.29batch/s]Predicting:  82%|████████▏ | 448/549 [01:37<00:15,  6.35batch/s]Predicting:  82%|████████▏ | 449/549 [01:37<00:17,  5.66batch/s]Predicting:  82%|████████▏ | 450/549 [01:38<00:20,  4.91batch/s]Predicting:  82%|████████▏ | 451/549 [01:38<00:20,  4.82batch/s]Predicting:  82%|████████▏ | 452/549 [01:38<00:19,  5.00batch/s]Predicting:  83%|████████▎ | 453/549 [01:38<00:18,  5.19batch/s]Predicting:  83%|████████▎ | 454/549 [01:38<00:16,  5.73batch/s]Predicting:  83%|████████▎ | 455/549 [01:39<00:15,  6.23batch/s]Predicting:  83%|████████▎ | 456/549 [01:39<00:16,  5.52batch/s]Predicting:  83%|████████▎ | 457/549 [01:39<00:18,  5.11batch/s]Predicting:  83%|████████▎ | 458/549 [01:39<00:17,  5.12batch/s]Predicting:  84%|████████▎ | 459/549 [01:39<00:16,  5.40batch/s]Predicting:  84%|████████▍ | 460/549 [01:40<00:17,  5.04batch/s]Predicting:  84%|████████▍ | 461/549 [01:40<00:17,  4.99batch/s]Predicting:  84%|████████▍ | 462/549 [01:40<00:18,  4.62batch/s]Predicting:  84%|████████▍ | 463/549 [01:40<00:16,  5.18batch/s]Predicting:  85%|████████▍ | 464/549 [01:40<00:15,  5.64batch/s]Predicting:  85%|████████▍ | 465/549 [01:40<00:13,  6.11batch/s]Predicting:  85%|████████▌ | 467/549 [01:41<00:10,  7.52batch/s]Predicting:  85%|████████▌ | 468/549 [01:41<00:12,  6.41batch/s]Predicting:  85%|████████▌ | 469/549 [01:41<00:11,  6.72batch/s]Predicting:  86%|████████▌ | 470/549 [01:41<00:13,  5.79batch/s]Predicting:  86%|████████▌ | 471/549 [01:41<00:14,  5.30batch/s]Predicting:  86%|████████▌ | 472/549 [01:42<00:15,  4.92batch/s]Predicting:  86%|████████▌ | 473/549 [01:42<00:14,  5.16batch/s]Predicting:  86%|████████▋ | 474/549 [01:42<00:13,  5.54batch/s]Predicting:  87%|████████▋ | 475/549 [01:42<00:12,  5.73batch/s]Predicting:  87%|████████▋ | 476/549 [01:42<00:12,  6.03batch/s]Predicting:  87%|████████▋ | 477/549 [01:42<00:12,  5.94batch/s]Predicting:  87%|████████▋ | 478/549 [01:43<00:12,  5.65batch/s]Predicting:  87%|████████▋ | 479/549 [01:43<00:12,  5.50batch/s]Predicting:  87%|████████▋ | 480/549 [01:43<00:13,  5.08batch/s]Predicting:  88%|████████▊ | 481/549 [01:43<00:14,  4.75batch/s]Predicting:  88%|████████▊ | 482/549 [01:43<00:12,  5.54batch/s]Predicting:  88%|████████▊ | 483/549 [01:44<00:12,  5.40batch/s]Predicting:  88%|████████▊ | 484/549 [01:44<00:10,  6.19batch/s]Predicting:  88%|████████▊ | 485/549 [01:44<00:09,  6.86batch/s]Predicting:  89%|████████▊ | 486/549 [01:44<00:10,  5.84batch/s]Predicting:  89%|████████▊ | 487/549 [01:44<00:11,  5.24batch/s]Predicting:  89%|████████▉ | 488/549 [01:45<00:12,  4.98batch/s]Predicting:  89%|████████▉ | 489/549 [01:45<00:12,  4.70batch/s]Predicting:  89%|████████▉ | 490/549 [01:45<00:10,  5.41batch/s]Predicting:  89%|████████▉ | 491/549 [01:45<00:10,  5.37batch/s]Predicting:  90%|████████▉ | 493/549 [01:45<00:07,  7.35batch/s]Predicting:  90%|████████▉ | 494/549 [01:45<00:07,  6.94batch/s]Predicting:  90%|█████████ | 495/549 [01:46<00:09,  5.83batch/s]Predicting:  90%|█████████ | 496/549 [01:46<00:09,  5.30batch/s]Predicting:  91%|█████████ | 497/549 [01:46<00:09,  5.48batch/s]Predicting:  91%|█████████ | 498/549 [01:46<00:08,  5.94batch/s]Predicting:  91%|█████████ | 499/549 [01:46<00:07,  6.44batch/s]Predicting:  91%|█████████ | 500/549 [01:46<00:06,  7.01batch/s]Predicting:  91%|█████████▏| 501/549 [01:47<00:06,  7.15batch/s]Predicting:  91%|█████████▏| 502/549 [01:47<00:07,  6.55batch/s]Predicting:  92%|█████████▏| 503/549 [01:47<00:06,  6.62batch/s]Predicting:  92%|█████████▏| 504/549 [01:47<00:08,  5.59batch/s]Predicting:  92%|█████████▏| 505/549 [01:47<00:08,  5.19batch/s]Predicting:  92%|█████████▏| 506/549 [01:48<00:09,  4.75batch/s]Predicting:  92%|█████████▏| 507/549 [01:48<00:08,  4.73batch/s]Predicting:  93%|█████████▎| 508/549 [01:48<00:08,  4.86batch/s]Predicting:  93%|█████████▎| 509/549 [01:48<00:08,  4.81batch/s]Predicting:  93%|█████████▎| 510/549 [01:48<00:07,  5.51batch/s]Predicting:  93%|█████████▎| 511/549 [01:48<00:06,  6.05batch/s]Predicting:  93%|█████████▎| 512/549 [01:49<00:05,  6.78batch/s]Predicting:  93%|█████████▎| 513/549 [01:49<00:04,  7.27batch/s]Predicting:  94%|█████████▎| 514/549 [01:49<00:04,  7.80batch/s]Predicting:  94%|█████████▍| 516/549 [01:49<00:04,  7.11batch/s]Predicting:  94%|█████████▍| 517/549 [01:49<00:05,  6.25batch/s]Predicting:  94%|█████████▍| 518/549 [01:50<00:04,  6.27batch/s]Predicting:  95%|█████████▍| 519/549 [01:50<00:05,  5.60batch/s]Predicting:  95%|█████████▍| 520/549 [01:50<00:05,  5.25batch/s]Predicting:  95%|█████████▍| 521/549 [01:50<00:05,  5.19batch/s]Predicting:  95%|█████████▌| 522/549 [01:50<00:05,  5.13batch/s]Predicting:  95%|█████████▌| 523/549 [01:51<00:04,  5.23batch/s]Predicting:  95%|█████████▌| 524/549 [01:51<00:04,  5.68batch/s]Predicting:  96%|█████████▌| 525/549 [01:51<00:04,  5.63batch/s]Predicting:  96%|█████████▌| 526/549 [01:51<00:03,  5.79batch/s]Predicting:  96%|█████████▌| 527/549 [01:51<00:03,  6.19batch/s]Predicting:  96%|█████████▋| 529/549 [01:51<00:02,  8.24batch/s]Predicting:  97%|█████████▋| 531/549 [01:51<00:01, 10.14batch/s]Predicting:  97%|█████████▋| 533/549 [01:52<00:01, 11.60batch/s]Predicting:  97%|█████████▋| 535/549 [01:52<00:01, 12.74batch/s]Predicting:  98%|█████████▊| 537/549 [01:52<00:00, 13.50batch/s]Predicting:  98%|█████████▊| 539/549 [01:52<00:00, 13.99batch/s]Predicting:  99%|█████████▊| 541/549 [01:52<00:00, 14.42batch/s]Predicting:  99%|█████████▉| 543/549 [01:52<00:00, 14.63batch/s]Predicting:  99%|█████████▉| 545/549 [01:52<00:00, 14.82batch/s]Predicting: 100%|█████████▉| 547/549 [01:52<00:00, 15.11batch/s]Predicting: 100%|██████████| 549/549 [01:53<00:00, 15.47batch/s]Predicting: 100%|██████████| 549/549 [01:53<00:00,  4.83batch/s]
INFO:state._cli._tx._predict:Creating anndatas from predictions from manual loop...
... storing 'target_gene' as categorical
... storing 'cell_type' as categorical
... storing 'batch_var' as categorical
... storing 'ctrl_cell_barcode' as categorical
... storing 'target_gene' as categorical
... storing 'cell_type' as categorical
... storing 'batch_var' as categorical
... storing 'ctrl_cell_barcode' as categorical
INFO:state._cli._tx._predict:Saved adata_pred to checkpoints/forth_run20251202/eval_step=step=22000-val_loss=val_loss=0.9084.ckpt/adata_pred.h5ad
INFO:state._cli._tx._predict:Saved adata_real to checkpoints/forth_run20251202/eval_step=step=22000-val_loss=val_loss=0.9084.ckpt/adata_real.h5ad
INFO:state._cli._tx._predict:Computing metrics using cell-eval...
WARNING:cell_eval._evaluator:Output directory checkpoints/forth_run20251202/eval_step=step=22000-val_loss=val_loss=0.9084.ckpt already exists, potential overwrite occurring
INFO:cell_eval.utils:Data appears to be log1p normalized (decimals detected, range [0.00, 7.60])
INFO:cell_eval._evaluator:Input is found to be log-normalized already - skipping transformation.
INFO:cell_eval.utils:Data appears to be log1p normalized (decimals detected, range [0.00, 12.29])
INFO:cell_eval._evaluator:Input is found to be log-normalized already - skipping transformation.
INFO:cell_eval._evaluator:Computing DE for real data
INFO:cell_eval._evaluator:Using the following pdex kwargs: {'exp_post_agg': True, 'is_log1p': True, 'reference': 'non-targeting', 'groupby_key': 'target_gene', 'num_workers': 40, 'batch_size': 2048, 'metric': 'wilcoxon', 'as_polars': True}
INFO:pdex._single_cell:Log1p status: True
INFO:pdex._single_cell:Precomputing masks for each target gene
Identifying target masks:   0%|          | 0/31 [00:00<?, ?it/s]Identifying target masks: 100%|██████████| 31/31 [00:00<00:00, 7571.83it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature
Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s]Identifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 2519201.92it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=560480
INFO:pdex._single_cell:Creating generator of all batches: N=274
INFO:pdex._single_cell:Initializing parallel processing pool
Traceback (most recent call last):
  File "/public/home/CS286/qiyt2023-CS286/miniconda3/envs/CellPerturb_VCC_Proj6_STATE2/bin/state", line 7, in <module>
    sys.exit(main())
  File "/public/home/CS286/qiyt2023-CS286/CellPerturb_VCC_Proj6_new4/STATE/src/state/__main__.py", line 123, in main
    run_tx_predict(args)
  File "/public/home/CS286/qiyt2023-CS286/CellPerturb_VCC_Proj6_new4/STATE/src/state/_cli/_tx/_predict.py", line 416, in run_tx_predict
    evaluator = MetricsEvaluator(
  File "/public/home/CS286/qiyt2023-CS286/miniconda3/envs/CellPerturb_VCC_Proj6_STATE2/lib/python3.10/site-packages/cell_eval/_evaluator.py", line 95, in __init__
    self.de_comparison = _build_de_comparison(
  File "/public/home/CS286/qiyt2023-CS286/miniconda3/envs/CellPerturb_VCC_Proj6_STATE2/lib/python3.10/site-packages/cell_eval/_evaluator.py", line 232, in _build_de_comparison
    real=_load_or_build_de(
  File "/public/home/CS286/qiyt2023-CS286/miniconda3/envs/CellPerturb_VCC_Proj6_STATE2/lib/python3.10/site-packages/cell_eval/_evaluator.py", line 316, in _load_or_build_de
    frame = parallel_differential_expression(
  File "/public/home/CS286/qiyt2023-CS286/miniconda3/envs/CellPerturb_VCC_Proj6_STATE2/lib/python3.10/site-packages/pdex/_single_cell.py", line 415, in parallel_differential_expression
    with mp.Pool(num_workers) as pool:
  File "/public/home/CS286/qiyt2023-CS286/miniconda3/envs/CellPerturb_VCC_Proj6_STATE2/lib/python3.10/multiprocessing/context.py", line 119, in Pool
    return Pool(processes, initializer, initargs, maxtasksperchild,
  File "/public/home/CS286/qiyt2023-CS286/miniconda3/envs/CellPerturb_VCC_Proj6_STATE2/lib/python3.10/multiprocessing/pool.py", line 215, in __init__
    self._repopulate_pool()
  File "/public/home/CS286/qiyt2023-CS286/miniconda3/envs/CellPerturb_VCC_Proj6_STATE2/lib/python3.10/multiprocessing/pool.py", line 306, in _repopulate_pool
    return self._repopulate_pool_static(self._ctx, self.Process,
  File "/public/home/CS286/qiyt2023-CS286/miniconda3/envs/CellPerturb_VCC_Proj6_STATE2/lib/python3.10/multiprocessing/pool.py", line 329, in _repopulate_pool_static
    w.start()
  File "/public/home/CS286/qiyt2023-CS286/miniconda3/envs/CellPerturb_VCC_Proj6_STATE2/lib/python3.10/multiprocessing/process.py", line 121, in start
    self._popen = self._Popen(self)
  File "/public/home/CS286/qiyt2023-CS286/miniconda3/envs/CellPerturb_VCC_Proj6_STATE2/lib/python3.10/multiprocessing/context.py", line 281, in _Popen
    return Popen(process_obj)
  File "/public/home/CS286/qiyt2023-CS286/miniconda3/envs/CellPerturb_VCC_Proj6_STATE2/lib/python3.10/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
  File "/public/home/CS286/qiyt2023-CS286/miniconda3/envs/CellPerturb_VCC_Proj6_STATE2/lib/python3.10/multiprocessing/popen_fork.py", line 66, in _launch
    self.pid = os.fork()
OSError: [Errno 12] Cannot allocate memory
/public/home/CS286/qiyt2023-CS286/miniconda3/envs/CellPerturb_VCC_Proj6_STATE2/lib/python3.10/multiprocessing/resource_tracker.py:224: UserWarning: resource_tracker: There appear to be 1 leaked shared_memory objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
